!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=80)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(5),i=n(2);class a extends Array{get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get z(){return this[2]}set z(t){this[2]=t}get magnitude(){return Math.hypot(...this)}get normalized(){const t=this.magnitude;return 0==t?o.zero():this.clone().div(o(t,t,t))}get negative(){return this.clone().negate()}get inversed(){return this.clone().inverse()}constructor(t,e,n){super(t,e,n)}static zero(){return new a(0,0,0)}static one(){return new a(1,1,1)}plus(t){return this[0]+=t[0],this[1]+=t[1],this[2]+=t[2],this}minus(t){return this[0]-=t[0],this[1]-=t[1],this[2]-=t[2],this}mul(t){return this[0]*=t[0],this[1]*=t[1],this[2]*=t[2],this}div(t){return this[0]/=t[0],this[1]/=t[1],this[2]/=t[2],this}dot(t){return this[0]*t[0]+this[1]*t[1]+this[2]*t[2]}normalize(){const t=this.magnitude;return 0==t?o.zero():this.clone().div(o(t,t,t))}inverse(){return this[0]=1/this[0],this[1]=1/this[1],this[2]=1/this[2],this}negate(){return this[0]=-this[0],this[1]=-this[1],this[2]=-this[2],this}cross(t){return o(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}clone(){return o(this[0],this[1],this[2])}__to(t){switch(t){case r.Vector4:return r.vec4(this[0],this[1],this[2],0);case i.Vector2:return i.vec2(this[0],this[1])}return this.clone()}}function o(t,e=t,n=t){return new a(t,e,n)}e.Vector3=a,e.vec3=o,o.from=t=>{const[e=0,n=0,r=0]=t;return o(e,n,r)},o.zero=a.zero,o.one=a.one},function(t,e,n){"use strict";let r;Object.defineProperty(e,"__esModule",{value:!0}),e.setGlobalContext=t=>r=t,e.GlobalContext=()=>r,e.GL=()=>e.GlobalContext().gl},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(5),i=n(0);class a extends Array{get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get magnitude(){return Math.hypot(...this)}get normalized(){const t=this.magnitude;return 0==t?o.zero():this.clone().div(o(t,t))}get negative(){return this.clone().negate()}get inversed(){return this.clone().inverse()}constructor(t,e){super(t,e)}static zero(){return new a(0,0)}static one(){return new a(1,1)}plus(t){return this[0]+=t[0],this[1]+=t[1],this}minus(t){return this[0]-=t[0],this[1]-=t[1],this}mul(t){return this[0]*=t[0],this[1]*=t[1],this}div(t){return this[0]/=t[0],this[1]/=t[1],this}dot(t){return this[0]*t[0]+this[1]*t[1]}normalize(){const t=this.magnitude;return 0==t?o.zero():this.clone().div(o(t,t))}inverse(){return this[0]=1/this[0],this[1]=1/this[1],this}negate(){return this[0]=-this[0],this[1]=-this[1],this}cross(t){return this.x*t.y-this.y*t.x}clone(){return o(this[0],this[1])}__to(t){switch(t){case r.Vector4:return r.vec4(this[0],this[1],0,0);case i.Vector3:return i.vec3(this[0],this[1],0)}return this.clone()}}function o(t,e=t){return new a(t,e)}e.Vector2=a,e.vec2=o,o.from=t=>{const[e=0,n=0]=t;return o(e,n)},o.zero=a.zero,o.one=a.one},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(21),e.panicNull=function(t,e){if(null===t)throw new Error(e);return t},e.panic=function(t){throw new Error(t)},e.warn=function(t){return console.warn(t),null},e.decorator=function(t,e,n=(t=>t)){const r=Symbol(t);return[t=>(void 0===t&&(t=e),Reflect.metadata(r,n(t))),(t,e)=>void 0===e?Reflect.getMetadata(r,t):Reflect.getMetadata(r,t,e)]},e.getUniformsLocation=function(t,e,n){const r={};for(const i in n)r[i]=t.getUniformLocation(e,n[i]);return r},e.fillArray=function(t,e){const n=new Array(e);for(let r=0;r<e;r++)n[r]="function"==typeof t?t(r):t;return n};e.DoubleBuffer=class{constructor(t){this.currentIdx=0,this.buffers=[t(),t()]}get current(){return this.buffers[this.currentIdx%2]}set current(t){this.buffers[this.currentIdx%2]=t}get back(){return this.buffers[(this.currentIdx+1)%2]}set back(t){this.buffers[(this.currentIdx+1)%2]=t}update(){this.currentIdx++}},e.setImmediate=function(t){setTimeout(t,0)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(5);class i extends r.Vector4{get r(){return this[0]}set r(t){this[0]=t}get g(){return this[1]}set g(t){this[1]=t}get b(){return this[2]}set b(t){this[2]=t}get a(){return this[3]}set a(t){this[3]=t}constructor(t,e,n,r=1){super(t,e,n,r)}static get white(){return new i(1,1,1)}static get transparent(){return new i(1,1,1,0)}static get black(){return new i(0,0,0)}static get red(){return new i(1,0,0)}static get green(){return new i(0,1,0)}static get blue(){return new i(0,0,1)}static get cyan(){return new i(0,1,1)}static get yellow(){return new i(1,1,0)}static get magenta(){return new i(1,0,1)}static get gray(){return new i(.5,.5,.5)}}e.Color=i,e.rgba=(t,e,n,r=1)=>new i(t,e,n,r),e.rgb=(t,e,n)=>new i(t,e,n,1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(2);class a extends Array{get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get z(){return this[2]}set z(t){this[2]=t}get w(){return this[3]}set w(t){this[3]=t}get magnitude(){return Math.hypot(...this)}get normalized(){const t=this.magnitude;return 0==t?o.zero():this.clone().div(o(t,t,t,t))}get negative(){return this.clone().negate()}get inversed(){return this.clone().inverse()}constructor(t,e,n=0,r=0){super(t,e,n||0,r||0)}static zero(){return new a(0,0,0,0)}static one(){return new a(1,1,1,1)}plus(t){return this[0]+=t[0],this[1]+=t[1],this[2]+=t[2],this[3]+=t[3],this}minus(t){return this[0]-=t[0],this[1]-=t[1],this[2]-=t[2],this[3]-=t[3],this}mul(t){return this[0]*=t[0],this[1]*=t[1],this[2]*=t[2],this[3]*=t[3],this}div(t){return this[0]/=t[0],this[1]/=t[1],this[2]/=t[2],this[3]/=t[3],this}dot(t){return this[0]*t[0]+this[1]*t[1]+this[2]*t[2]+this[3]*t[3]}normalize(){const t=this.magnitude;return 0==t?o.zero():this.clone().div(o(t,t,t,t))}inverse(){return this[0]=1/this[0],this[1]=1/this[1],this[2]=1/this[2],this[3]=1/this[3],this}negate(){return this[0]=-this[0],this[1]=-this[1],this[2]=-this[2],this[3]=-this[3],this}clone(){return o(this[0],this[1],this[2],this[3])}__to(t){switch(t){case a:return this.clone();case r.Vector3:return r.vec3(this[0],this[1],this[2]);case i.Vector2:return i.vec2(this[0],this[1])}return this.clone()}}function o(t,e=t,n=t,r=t){return new a(t,e,n,r)}e.Vector4=a,e.vec4=o,o.from=t=>{const[e=0,n=0,r=0,i=0]=t;return o(e,n,r,i)},o.zero=a.zero,o.one=a.one},function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(t[r]=n[r])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var a={arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){var e,n,r,i,a,o;for(r=0,e=0,n=t.length;e<n;e++)r+=t[e].length;for(o=new Uint8Array(r),i=0,e=0,n=t.length;e<n;e++)a=t[e],o.set(a,i),i+=a.length;return o}},o={arraySet:function(t,e,n,r,i){for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,a)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,o))},e.setTyped(r)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(3),i=n(11);e.Asset=class{constructor(t){this.destroyed=!1,this.assetID=e.AssetManager.newAssetID(this),this.name=t||`Asset_${this.assetID}`}destroy(){this.destroyed=!0,e.AssetManager.destroy(this.assetID)}};e.AssetManager=new class{constructor(){this.assetsMap=new Map,this.id=1,this.eventEmitter=new i.EventEmitter}newAssetID(t){const e=++this.id;return this.assetsMap.set(e,t),r.setImmediate(()=>this.eventEmitter.emit("asset-created",t)),t.assetID=e}find(t){if("number"==typeof t)return this.assetsMap.get(t);if("string"==typeof t)for(const e of this.assetsMap.values())if(e.name===t)return e}destroy(t){const e=this.assetsMap.get(t);e&&(this.assetsMap.delete(t),r.setImmediate(()=>this.eventEmitter.emit("asset-destroyed",e)))}findAssetsOfType(t){return Array.from(this.assetsMap.values()).filter(e=>e instanceof t)}on(t,e){return this.eventEmitter.on(t,e)}off(t,e){return this.eventEmitter.off(t,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9),i=n(0),a=n(5);function o(t){return r.mat4.clone(t)}e.Matrix4x4=o,o.identity=()=>{const t=r.mat4.create();return r.mat4.identity(t)},o.rts=(t,n,i)=>{const a=e.mat4.identity();return r.mat4.fromRotationTranslationScale(a,t,n,i),a},o.translate=t=>{const n=e.mat4.identity();return r.mat4.translate(n,r.mat4.identity(n),t)},o.invert=t=>{const e=r.mat4.create();return r.mat4.invert(e,t),e},o.getTranslation=t=>{let e=i.vec3(0,0,0);return r.mat4.getTranslation(e,t),e},o.getRotation=t=>{let e=r.quat.create();return r.mat4.getRotation(e,t),e},o.getScaling=t=>{let e=i.vec3(0,0,0);return r.mat4.getScaling(e,t),e},o.mulPoint=(t,e)=>{let n=a.vec4(e.x,e.y,e.z,1),o=a.vec4.zero();return r.vec4.transformMat4(o,n,t),i.vec3(o.x,o.y,o.z)},o.mulVector=(t,e)=>{let n=a.vec4(e.x,e.y,e.z,0),o=a.vec4.zero();return r.vec4.transformMat4(o,n,t),i.vec3(o.x,o.y,o.z)},o.mulVec4=(t,e)=>{let n=a.vec4.zero();return r.vec4.transformMat4(n,e,t),n},o.perspective=(t,e,n,i)=>{const a=r.mat4.create();return r.mat4.perspective(a,t,e,n,i)},o.transpose=t=>r.mat4.transpose(r.mat4.create(),t),o.ortho=(t,e,n,i)=>{const a=r.mat4.create();return a[0]=1/(e*t),a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1/t,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=-2/(i-n),a[11]=-(i+n)/(i-n),a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},o.rotate=(t,e,n)=>r.mat4.rotate(r.mat4.create(),t,n,e),o.scale=(t,e)=>r.mat4.scale(r.mat4.create(),t,e),o.fromRotation=(t,e)=>r.mat4.fromRotation(r.mat4.create(),e,t),o.fromScaling=t=>r.mat4.fromScaling(r.mat4.create(),t),o.mul=(t,e,n)=>(n||(n=e,e=t,t=r.mat4.create()),r.mat4.mul(t,e,n)),e.mat4=o},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"EPSILON",(function(){return d})),n.d(r,"ARRAY_TYPE",(function(){return m})),n.d(r,"RANDOM",(function(){return v})),n.d(r,"setMatrixArrayType",(function(){return p})),n.d(r,"toRadian",(function(){return _})),n.d(r,"equals",(function(){return b}));var i={};n.r(i),n.d(i,"create",(function(){return w})),n.d(i,"clone",(function(){return y})),n.d(i,"copy",(function(){return M})),n.d(i,"identity",(function(){return x})),n.d(i,"fromValues",(function(){return T})),n.d(i,"set",(function(){return E})),n.d(i,"transpose",(function(){return R})),n.d(i,"invert",(function(){return A})),n.d(i,"adjoint",(function(){return k})),n.d(i,"determinant",(function(){return P})),n.d(i,"multiply",(function(){return S})),n.d(i,"rotate",(function(){return B})),n.d(i,"scale",(function(){return F})),n.d(i,"fromRotation",(function(){return L})),n.d(i,"fromScaling",(function(){return C})),n.d(i,"str",(function(){return D})),n.d(i,"frob",(function(){return I})),n.d(i,"LDU",(function(){return N})),n.d(i,"add",(function(){return U})),n.d(i,"subtract",(function(){return O})),n.d(i,"exactEquals",(function(){return G})),n.d(i,"equals",(function(){return z})),n.d(i,"multiplyScalar",(function(){return V})),n.d(i,"multiplyScalarAndAdd",(function(){return j})),n.d(i,"mul",(function(){return q})),n.d(i,"sub",(function(){return H}));var a={};n.r(a),n.d(a,"create",(function(){return W})),n.d(a,"clone",(function(){return K})),n.d(a,"copy",(function(){return Z})),n.d(a,"identity",(function(){return X})),n.d(a,"fromValues",(function(){return Y})),n.d(a,"set",(function(){return $})),n.d(a,"invert",(function(){return Q})),n.d(a,"determinant",(function(){return J})),n.d(a,"multiply",(function(){return tt})),n.d(a,"rotate",(function(){return et})),n.d(a,"scale",(function(){return nt})),n.d(a,"translate",(function(){return rt})),n.d(a,"fromRotation",(function(){return it})),n.d(a,"fromScaling",(function(){return at})),n.d(a,"fromTranslation",(function(){return ot})),n.d(a,"str",(function(){return st})),n.d(a,"frob",(function(){return ut})),n.d(a,"add",(function(){return ct})),n.d(a,"subtract",(function(){return lt})),n.d(a,"multiplyScalar",(function(){return ht})),n.d(a,"multiplyScalarAndAdd",(function(){return ft})),n.d(a,"exactEquals",(function(){return dt})),n.d(a,"equals",(function(){return mt})),n.d(a,"mul",(function(){return vt})),n.d(a,"sub",(function(){return pt}));var o={};n.r(o),n.d(o,"create",(function(){return gt})),n.d(o,"fromMat4",(function(){return _t})),n.d(o,"clone",(function(){return bt})),n.d(o,"copy",(function(){return wt})),n.d(o,"fromValues",(function(){return yt})),n.d(o,"set",(function(){return Mt})),n.d(o,"identity",(function(){return xt})),n.d(o,"transpose",(function(){return Tt})),n.d(o,"invert",(function(){return Et})),n.d(o,"adjoint",(function(){return Rt})),n.d(o,"determinant",(function(){return At})),n.d(o,"multiply",(function(){return kt})),n.d(o,"translate",(function(){return Pt})),n.d(o,"rotate",(function(){return St})),n.d(o,"scale",(function(){return Bt})),n.d(o,"fromTranslation",(function(){return Ft})),n.d(o,"fromRotation",(function(){return Lt})),n.d(o,"fromScaling",(function(){return Ct})),n.d(o,"fromMat2d",(function(){return Dt})),n.d(o,"fromQuat",(function(){return It})),n.d(o,"normalFromMat4",(function(){return Nt})),n.d(o,"projection",(function(){return Ut})),n.d(o,"str",(function(){return Ot})),n.d(o,"frob",(function(){return Gt})),n.d(o,"add",(function(){return zt})),n.d(o,"subtract",(function(){return Vt})),n.d(o,"multiplyScalar",(function(){return jt})),n.d(o,"multiplyScalarAndAdd",(function(){return qt})),n.d(o,"exactEquals",(function(){return Ht})),n.d(o,"equals",(function(){return Wt})),n.d(o,"mul",(function(){return Kt})),n.d(o,"sub",(function(){return Zt}));var s={};n.r(s),n.d(s,"create",(function(){return Xt})),n.d(s,"clone",(function(){return Yt})),n.d(s,"copy",(function(){return $t})),n.d(s,"fromValues",(function(){return Qt})),n.d(s,"set",(function(){return Jt})),n.d(s,"identity",(function(){return te})),n.d(s,"transpose",(function(){return ee})),n.d(s,"invert",(function(){return ne})),n.d(s,"adjoint",(function(){return re})),n.d(s,"determinant",(function(){return ie})),n.d(s,"multiply",(function(){return ae})),n.d(s,"translate",(function(){return oe})),n.d(s,"scale",(function(){return se})),n.d(s,"rotate",(function(){return ue})),n.d(s,"rotateX",(function(){return ce})),n.d(s,"rotateY",(function(){return le})),n.d(s,"rotateZ",(function(){return he})),n.d(s,"fromTranslation",(function(){return fe})),n.d(s,"fromScaling",(function(){return de})),n.d(s,"fromRotation",(function(){return me})),n.d(s,"fromXRotation",(function(){return ve})),n.d(s,"fromYRotation",(function(){return pe})),n.d(s,"fromZRotation",(function(){return ge})),n.d(s,"fromRotationTranslation",(function(){return _e})),n.d(s,"fromQuat2",(function(){return be})),n.d(s,"getTranslation",(function(){return we})),n.d(s,"getScaling",(function(){return ye})),n.d(s,"getRotation",(function(){return Me})),n.d(s,"fromRotationTranslationScale",(function(){return xe})),n.d(s,"fromRotationTranslationScaleOrigin",(function(){return Te})),n.d(s,"fromQuat",(function(){return Ee})),n.d(s,"frustum",(function(){return Re})),n.d(s,"perspective",(function(){return Ae})),n.d(s,"perspectiveFromFieldOfView",(function(){return ke})),n.d(s,"ortho",(function(){return Pe})),n.d(s,"lookAt",(function(){return Se})),n.d(s,"targetTo",(function(){return Be})),n.d(s,"str",(function(){return Fe})),n.d(s,"frob",(function(){return Le})),n.d(s,"add",(function(){return Ce})),n.d(s,"subtract",(function(){return De})),n.d(s,"multiplyScalar",(function(){return Ie})),n.d(s,"multiplyScalarAndAdd",(function(){return Ne})),n.d(s,"exactEquals",(function(){return Ue})),n.d(s,"equals",(function(){return Oe})),n.d(s,"mul",(function(){return Ge})),n.d(s,"sub",(function(){return ze}));var u={};n.r(u),n.d(u,"create",(function(){return Ve})),n.d(u,"clone",(function(){return je})),n.d(u,"length",(function(){return qe})),n.d(u,"fromValues",(function(){return He})),n.d(u,"copy",(function(){return We})),n.d(u,"set",(function(){return Ke})),n.d(u,"add",(function(){return Ze})),n.d(u,"subtract",(function(){return Xe})),n.d(u,"multiply",(function(){return Ye})),n.d(u,"divide",(function(){return $e})),n.d(u,"ceil",(function(){return Qe})),n.d(u,"floor",(function(){return Je})),n.d(u,"min",(function(){return tn})),n.d(u,"max",(function(){return en})),n.d(u,"round",(function(){return nn})),n.d(u,"scale",(function(){return rn})),n.d(u,"scaleAndAdd",(function(){return an})),n.d(u,"distance",(function(){return on})),n.d(u,"squaredDistance",(function(){return sn})),n.d(u,"squaredLength",(function(){return un})),n.d(u,"negate",(function(){return cn})),n.d(u,"inverse",(function(){return ln})),n.d(u,"normalize",(function(){return hn})),n.d(u,"dot",(function(){return fn})),n.d(u,"cross",(function(){return dn})),n.d(u,"lerp",(function(){return mn})),n.d(u,"hermite",(function(){return vn})),n.d(u,"bezier",(function(){return pn})),n.d(u,"random",(function(){return gn})),n.d(u,"transformMat4",(function(){return _n})),n.d(u,"transformMat3",(function(){return bn})),n.d(u,"transformQuat",(function(){return wn})),n.d(u,"rotateX",(function(){return yn})),n.d(u,"rotateY",(function(){return Mn})),n.d(u,"rotateZ",(function(){return xn})),n.d(u,"angle",(function(){return Tn})),n.d(u,"zero",(function(){return En})),n.d(u,"str",(function(){return Rn})),n.d(u,"exactEquals",(function(){return An})),n.d(u,"equals",(function(){return kn})),n.d(u,"sub",(function(){return Sn})),n.d(u,"mul",(function(){return Bn})),n.d(u,"div",(function(){return Fn})),n.d(u,"dist",(function(){return Ln})),n.d(u,"sqrDist",(function(){return Cn})),n.d(u,"len",(function(){return Dn})),n.d(u,"sqrLen",(function(){return In})),n.d(u,"forEach",(function(){return Nn}));var c={};n.r(c),n.d(c,"create",(function(){return Un})),n.d(c,"clone",(function(){return On})),n.d(c,"fromValues",(function(){return Gn})),n.d(c,"copy",(function(){return zn})),n.d(c,"set",(function(){return Vn})),n.d(c,"add",(function(){return jn})),n.d(c,"subtract",(function(){return qn})),n.d(c,"multiply",(function(){return Hn})),n.d(c,"divide",(function(){return Wn})),n.d(c,"ceil",(function(){return Kn})),n.d(c,"floor",(function(){return Zn})),n.d(c,"min",(function(){return Xn})),n.d(c,"max",(function(){return Yn})),n.d(c,"round",(function(){return $n})),n.d(c,"scale",(function(){return Qn})),n.d(c,"scaleAndAdd",(function(){return Jn})),n.d(c,"distance",(function(){return tr})),n.d(c,"squaredDistance",(function(){return er})),n.d(c,"length",(function(){return nr})),n.d(c,"squaredLength",(function(){return rr})),n.d(c,"negate",(function(){return ir})),n.d(c,"inverse",(function(){return ar})),n.d(c,"normalize",(function(){return or})),n.d(c,"dot",(function(){return sr})),n.d(c,"cross",(function(){return ur})),n.d(c,"lerp",(function(){return cr})),n.d(c,"random",(function(){return lr})),n.d(c,"transformMat4",(function(){return hr})),n.d(c,"transformQuat",(function(){return fr})),n.d(c,"zero",(function(){return dr})),n.d(c,"str",(function(){return mr})),n.d(c,"exactEquals",(function(){return vr})),n.d(c,"equals",(function(){return pr})),n.d(c,"sub",(function(){return gr})),n.d(c,"mul",(function(){return _r})),n.d(c,"div",(function(){return br})),n.d(c,"dist",(function(){return wr})),n.d(c,"sqrDist",(function(){return yr})),n.d(c,"len",(function(){return Mr})),n.d(c,"sqrLen",(function(){return xr})),n.d(c,"forEach",(function(){return Tr}));var l={};n.r(l),n.d(l,"create",(function(){return Er})),n.d(l,"identity",(function(){return Rr})),n.d(l,"setAxisAngle",(function(){return Ar})),n.d(l,"getAxisAngle",(function(){return kr})),n.d(l,"getAngle",(function(){return Pr})),n.d(l,"multiply",(function(){return Sr})),n.d(l,"rotateX",(function(){return Br})),n.d(l,"rotateY",(function(){return Fr})),n.d(l,"rotateZ",(function(){return Lr})),n.d(l,"calculateW",(function(){return Cr})),n.d(l,"exp",(function(){return Dr})),n.d(l,"ln",(function(){return Ir})),n.d(l,"pow",(function(){return Nr})),n.d(l,"slerp",(function(){return Ur})),n.d(l,"random",(function(){return Or})),n.d(l,"invert",(function(){return Gr})),n.d(l,"conjugate",(function(){return zr})),n.d(l,"fromMat3",(function(){return Vr})),n.d(l,"fromEuler",(function(){return jr})),n.d(l,"str",(function(){return qr})),n.d(l,"clone",(function(){return $r})),n.d(l,"fromValues",(function(){return Qr})),n.d(l,"copy",(function(){return Jr})),n.d(l,"set",(function(){return ti})),n.d(l,"add",(function(){return ei})),n.d(l,"mul",(function(){return ni})),n.d(l,"scale",(function(){return ri})),n.d(l,"dot",(function(){return ii})),n.d(l,"lerp",(function(){return ai})),n.d(l,"length",(function(){return oi})),n.d(l,"len",(function(){return si})),n.d(l,"squaredLength",(function(){return ui})),n.d(l,"sqrLen",(function(){return ci})),n.d(l,"normalize",(function(){return li})),n.d(l,"exactEquals",(function(){return hi})),n.d(l,"equals",(function(){return fi})),n.d(l,"rotationTo",(function(){return di})),n.d(l,"sqlerp",(function(){return mi})),n.d(l,"setAxes",(function(){return vi}));var h={};n.r(h),n.d(h,"create",(function(){return pi})),n.d(h,"clone",(function(){return gi})),n.d(h,"fromValues",(function(){return _i})),n.d(h,"fromRotationTranslationValues",(function(){return bi})),n.d(h,"fromRotationTranslation",(function(){return wi})),n.d(h,"fromTranslation",(function(){return yi})),n.d(h,"fromRotation",(function(){return Mi})),n.d(h,"fromMat4",(function(){return xi})),n.d(h,"copy",(function(){return Ti})),n.d(h,"identity",(function(){return Ei})),n.d(h,"set",(function(){return Ri})),n.d(h,"getReal",(function(){return Ai})),n.d(h,"getDual",(function(){return ki})),n.d(h,"setReal",(function(){return Pi})),n.d(h,"setDual",(function(){return Si})),n.d(h,"getTranslation",(function(){return Bi})),n.d(h,"translate",(function(){return Fi})),n.d(h,"rotateX",(function(){return Li})),n.d(h,"rotateY",(function(){return Ci})),n.d(h,"rotateZ",(function(){return Di})),n.d(h,"rotateByQuatAppend",(function(){return Ii})),n.d(h,"rotateByQuatPrepend",(function(){return Ni})),n.d(h,"rotateAroundAxis",(function(){return Ui})),n.d(h,"add",(function(){return Oi})),n.d(h,"multiply",(function(){return Gi})),n.d(h,"mul",(function(){return zi})),n.d(h,"scale",(function(){return Vi})),n.d(h,"dot",(function(){return ji})),n.d(h,"lerp",(function(){return qi})),n.d(h,"invert",(function(){return Hi})),n.d(h,"conjugate",(function(){return Wi})),n.d(h,"length",(function(){return Ki})),n.d(h,"len",(function(){return Zi})),n.d(h,"squaredLength",(function(){return Xi})),n.d(h,"sqrLen",(function(){return Yi})),n.d(h,"normalize",(function(){return $i})),n.d(h,"str",(function(){return Qi})),n.d(h,"exactEquals",(function(){return Ji})),n.d(h,"equals",(function(){return ta}));var f={};n.r(f),n.d(f,"create",(function(){return ea})),n.d(f,"clone",(function(){return na})),n.d(f,"fromValues",(function(){return ra})),n.d(f,"copy",(function(){return ia})),n.d(f,"set",(function(){return aa})),n.d(f,"add",(function(){return oa})),n.d(f,"subtract",(function(){return sa})),n.d(f,"multiply",(function(){return ua})),n.d(f,"divide",(function(){return ca})),n.d(f,"ceil",(function(){return la})),n.d(f,"floor",(function(){return ha})),n.d(f,"min",(function(){return fa})),n.d(f,"max",(function(){return da})),n.d(f,"round",(function(){return ma})),n.d(f,"scale",(function(){return va})),n.d(f,"scaleAndAdd",(function(){return pa})),n.d(f,"distance",(function(){return ga})),n.d(f,"squaredDistance",(function(){return _a})),n.d(f,"length",(function(){return ba})),n.d(f,"squaredLength",(function(){return wa})),n.d(f,"negate",(function(){return ya})),n.d(f,"inverse",(function(){return Ma})),n.d(f,"normalize",(function(){return xa})),n.d(f,"dot",(function(){return Ta})),n.d(f,"cross",(function(){return Ea})),n.d(f,"lerp",(function(){return Ra})),n.d(f,"random",(function(){return Aa})),n.d(f,"transformMat2",(function(){return ka})),n.d(f,"transformMat2d",(function(){return Pa})),n.d(f,"transformMat3",(function(){return Sa})),n.d(f,"transformMat4",(function(){return Ba})),n.d(f,"rotate",(function(){return Fa})),n.d(f,"angle",(function(){return La})),n.d(f,"zero",(function(){return Ca})),n.d(f,"str",(function(){return Da})),n.d(f,"exactEquals",(function(){return Ia})),n.d(f,"equals",(function(){return Na})),n.d(f,"len",(function(){return Ua})),n.d(f,"sub",(function(){return Oa})),n.d(f,"mul",(function(){return Ga})),n.d(f,"div",(function(){return za})),n.d(f,"dist",(function(){return Va})),n.d(f,"sqrDist",(function(){return ja})),n.d(f,"sqrLen",(function(){return qa})),n.d(f,"forEach",(function(){return Ha}));var d=1e-6,m="undefined"!=typeof Float32Array?Float32Array:Array,v=Math.random;function p(t){m=t}var g=Math.PI/180;function _(t){return t*g}function b(t,e){return Math.abs(t-e)<=d*Math.max(1,Math.abs(t),Math.abs(e))}function w(){var t=new m(4);return m!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function y(t){var e=new m(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function M(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function x(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function T(t,e,n,r){var i=new m(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function E(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function R(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function A(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*a-i*r;return o?(o=1/o,t[0]=a*o,t[1]=-r*o,t[2]=-i*o,t[3]=n*o,t):null}function k(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function P(t){return t[0]*t[3]-t[2]*t[1]}function S(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*s+a*u,t[1]=i*s+o*u,t[2]=r*c+a*l,t[3]=i*c+o*l,t}function B(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=r*-s+a*u,t[3]=i*-s+o*u,t}function F(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=i*s,t[2]=a*u,t[3]=o*u,t}function L(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t}function C(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function D(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function I(t){return Math.hypot(t[0],t[1],t[2],t[3])}function N(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]}function U(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function O(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function G(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function z(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=d*Math.max(1,Math.abs(a),Math.abs(c))}function V(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function j(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var q=S,H=O;function W(){var t=new m(6);return m!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function K(t){var e=new m(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Z(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function X(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Y(t,e,n,r,i,a){var o=new m(6);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o[4]=i,o[5]=a,o}function $(t,e,n,r,i,a,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t}function Q(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=n*a-r*i;return u?(u=1/u,t[0]=a*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*s-a*o)*u,t[5]=(r*o-n*s)*u,t):null}function J(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=n[0],l=n[1],h=n[2],f=n[3],d=n[4],m=n[5];return t[0]=r*c+a*l,t[1]=i*c+o*l,t[2]=r*h+a*f,t[3]=i*h+o*f,t[4]=r*d+a*m+s,t[5]=i*d+o*m+u,t}function et(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=Math.sin(n),l=Math.cos(n);return t[0]=r*l+a*c,t[1]=i*l+o*c,t[2]=r*-c+a*l,t[3]=i*-c+o*l,t[4]=s,t[5]=u,t}function nt(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=n[0],l=n[1];return t[0]=r*c,t[1]=i*c,t[2]=a*l,t[3]=o*l,t[4]=s,t[5]=u,t}function rt(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=n[0],l=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=r*c+a*l+s,t[5]=i*c+o*l+u,t}function it(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function at(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function st(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function lt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function ht(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function ft(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function dt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function mt(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=e[0],c=e[1],l=e[2],h=e[3],f=e[4],m=e[5];return Math.abs(n-u)<=d*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-c)<=d*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-l)<=d*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-h)<=d*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(o-f)<=d*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-m)<=d*Math.max(1,Math.abs(s),Math.abs(m))}var vt=tt,pt=lt;function gt(){var t=new m(9);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function _t(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function bt(t){var e=new m(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function wt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function yt(t,e,n,r,i,a,o,s,u){var c=new m(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=a,c[6]=o,c[7]=s,c[8]=u,c}function Mt(t,e,n,r,i,a,o,s,u,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t}function xt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Tt(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Et(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=l*o-s*c,f=-l*a+s*u,d=c*a-o*u,m=n*h+r*f+i*d;return m?(m=1/m,t[0]=h*m,t[1]=(-l*r+i*c)*m,t[2]=(s*r-i*o)*m,t[3]=f*m,t[4]=(l*n-i*u)*m,t[5]=(-s*n+i*a)*m,t[6]=d*m,t[7]=(-c*n+r*u)*m,t[8]=(o*n-r*a)*m,t):null}function Rt(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8];return t[0]=o*l-s*c,t[1]=i*c-r*l,t[2]=r*s-i*o,t[3]=s*u-a*l,t[4]=n*l-i*u,t[5]=i*a-n*s,t[6]=a*c-o*u,t[7]=r*u-n*c,t[8]=n*o-r*a,t}function At(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8];return e*(c*a-o*u)+n*(-c*i+o*s)+r*(u*i-a*s)}function kt(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=n[0],d=n[1],m=n[2],v=n[3],p=n[4],g=n[5],_=n[6],b=n[7],w=n[8];return t[0]=f*r+d*o+m*c,t[1]=f*i+d*s+m*l,t[2]=f*a+d*u+m*h,t[3]=v*r+p*o+g*c,t[4]=v*i+p*s+g*l,t[5]=v*a+p*u+g*h,t[6]=_*r+b*o+w*c,t[7]=_*i+b*s+w*l,t[8]=_*a+b*u+w*h,t}function Pt(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=f*r+d*o+c,t[7]=f*i+d*s+l,t[8]=f*a+d*u+h,t}function St(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*r+f*o,t[1]=d*i+f*s,t[2]=d*a+f*u,t[3]=d*o-f*r,t[4]=d*s-f*i,t[5]=d*u-f*a,t[6]=c,t[7]=l,t[8]=h,t}function Bt(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ft(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Lt(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ct(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Dt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function It(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,u=i+i,c=n*o,l=r*o,h=r*s,f=i*o,d=i*s,m=i*u,v=a*o,p=a*s,g=a*u;return t[0]=1-h-m,t[3]=l-g,t[6]=f+p,t[1]=l+g,t[4]=1-c-m,t[7]=d-v,t[2]=f-p,t[5]=d+v,t[8]=1-c-h,t}function Nt(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],m=e[12],v=e[13],p=e[14],g=e[15],_=n*s-r*o,b=n*u-i*o,w=n*c-a*o,y=r*u-i*s,M=r*c-a*s,x=i*c-a*u,T=l*v-h*m,E=l*p-f*m,R=l*g-d*m,A=h*p-f*v,k=h*g-d*v,P=f*g-d*p,S=_*P-b*k+w*A+y*R-M*E+x*T;return S?(S=1/S,t[0]=(s*P-u*k+c*A)*S,t[1]=(u*R-o*P-c*E)*S,t[2]=(o*k-s*R+c*T)*S,t[3]=(i*k-r*P-a*A)*S,t[4]=(n*P-i*R+a*E)*S,t[5]=(r*R-n*k-a*T)*S,t[6]=(v*x-p*M+g*y)*S,t[7]=(p*w-m*x-g*b)*S,t[8]=(m*M-v*w+g*_)*S,t):null}function Ut(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Ot(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Gt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function zt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function Vt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function jt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function qt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Ht(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Wt(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=e[0],f=e[1],m=e[2],v=e[3],p=e[4],g=e[5],_=e[6],b=e[7],w=e[8];return Math.abs(n-h)<=d*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-f)<=d*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-m)<=d*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(a-v)<=d*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(o-p)<=d*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-g)<=d*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-_)<=d*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(c-b)<=d*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(l-w)<=d*Math.max(1,Math.abs(l),Math.abs(w))}var Kt=kt,Zt=Vt;function Xt(){var t=new m(16);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Yt(t){var e=new m(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function $t(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Qt(t,e,n,r,i,a,o,s,u,c,l,h,f,d,v,p){var g=new m(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=r,g[4]=i,g[5]=a,g[6]=o,g[7]=s,g[8]=u,g[9]=c,g[10]=l,g[11]=h,g[12]=f,g[13]=d,g[14]=v,g[15]=p,g}function Jt(t,e,n,r,i,a,o,s,u,c,l,h,f,d,m,v,p){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=h,t[11]=f,t[12]=d,t[13]=m,t[14]=v,t[15]=p,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ne(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],m=e[12],v=e[13],p=e[14],g=e[15],_=n*s-r*o,b=n*u-i*o,w=n*c-a*o,y=r*u-i*s,M=r*c-a*s,x=i*c-a*u,T=l*v-h*m,E=l*p-f*m,R=l*g-d*m,A=h*p-f*v,k=h*g-d*v,P=f*g-d*p,S=_*P-b*k+w*A+y*R-M*E+x*T;return S?(S=1/S,t[0]=(s*P-u*k+c*A)*S,t[1]=(i*k-r*P-a*A)*S,t[2]=(v*x-p*M+g*y)*S,t[3]=(f*M-h*x-d*y)*S,t[4]=(u*R-o*P-c*E)*S,t[5]=(n*P-i*R+a*E)*S,t[6]=(p*w-m*x-g*b)*S,t[7]=(l*x-f*w+d*b)*S,t[8]=(o*k-s*R+c*T)*S,t[9]=(r*R-n*k-a*T)*S,t[10]=(m*M-v*w+g*_)*S,t[11]=(h*w-l*M-d*_)*S,t[12]=(s*E-o*A-u*T)*S,t[13]=(n*A-r*E+i*T)*S,t[14]=(v*b-m*y-p*_)*S,t[15]=(l*y-h*b+f*_)*S,t):null}function re(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],m=e[12],v=e[13],p=e[14],g=e[15];return t[0]=s*(f*g-d*p)-h*(u*g-c*p)+v*(u*d-c*f),t[1]=-(r*(f*g-d*p)-h*(i*g-a*p)+v*(i*d-a*f)),t[2]=r*(u*g-c*p)-s*(i*g-a*p)+v*(i*c-a*u),t[3]=-(r*(u*d-c*f)-s*(i*d-a*f)+h*(i*c-a*u)),t[4]=-(o*(f*g-d*p)-l*(u*g-c*p)+m*(u*d-c*f)),t[5]=n*(f*g-d*p)-l*(i*g-a*p)+m*(i*d-a*f),t[6]=-(n*(u*g-c*p)-o*(i*g-a*p)+m*(i*c-a*u)),t[7]=n*(u*d-c*f)-o*(i*d-a*f)+l*(i*c-a*u),t[8]=o*(h*g-d*v)-l*(s*g-c*v)+m*(s*d-c*h),t[9]=-(n*(h*g-d*v)-l*(r*g-a*v)+m*(r*d-a*h)),t[10]=n*(s*g-c*v)-o*(r*g-a*v)+m*(r*c-a*s),t[11]=-(n*(s*d-c*h)-o*(r*d-a*h)+l*(r*c-a*s)),t[12]=-(o*(h*p-f*v)-l*(s*p-u*v)+m*(s*f-u*h)),t[13]=n*(h*p-f*v)-l*(r*p-i*v)+m*(r*f-i*h),t[14]=-(n*(s*p-u*v)-o*(r*p-i*v)+m*(r*u-i*s)),t[15]=n*(s*f-u*h)-o*(r*f-i*h)+l*(r*u-i*s),t}function ie(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],d=t[12],m=t[13],v=t[14],p=t[15];return(e*o-n*a)*(h*p-f*v)-(e*s-r*a)*(l*p-f*m)+(e*u-i*a)*(l*v-h*m)+(n*s-r*o)*(c*p-f*d)-(n*u-i*o)*(c*v-h*d)+(r*u-i*s)*(c*m-l*d)}function ae(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],m=e[11],v=e[12],p=e[13],g=e[14],_=e[15],b=n[0],w=n[1],y=n[2],M=n[3];return t[0]=b*r+w*s+y*h+M*v,t[1]=b*i+w*u+y*f+M*p,t[2]=b*a+w*c+y*d+M*g,t[3]=b*o+w*l+y*m+M*_,b=n[4],w=n[5],y=n[6],M=n[7],t[4]=b*r+w*s+y*h+M*v,t[5]=b*i+w*u+y*f+M*p,t[6]=b*a+w*c+y*d+M*g,t[7]=b*o+w*l+y*m+M*_,b=n[8],w=n[9],y=n[10],M=n[11],t[8]=b*r+w*s+y*h+M*v,t[9]=b*i+w*u+y*f+M*p,t[10]=b*a+w*c+y*d+M*g,t[11]=b*o+w*l+y*m+M*_,b=n[12],w=n[13],y=n[14],M=n[15],t[12]=b*r+w*s+y*h+M*v,t[13]=b*i+w*u+y*f+M*p,t[14]=b*a+w*c+y*d+M*g,t[15]=b*o+w*l+y*m+M*_,t}function oe(t,e,n){var r,i,a,o,s,u,c,l,h,f,d,m,v=n[0],p=n[1],g=n[2];return e===t?(t[12]=e[0]*v+e[4]*p+e[8]*g+e[12],t[13]=e[1]*v+e[5]*p+e[9]*g+e[13],t[14]=e[2]*v+e[6]*p+e[10]*g+e[14],t[15]=e[3]*v+e[7]*p+e[11]*g+e[15]):(r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],m=e[11],t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=m,t[12]=r*v+s*p+h*g+e[12],t[13]=i*v+u*p+f*g+e[13],t[14]=a*v+c*p+d*g+e[14],t[15]=o*v+l*p+m*g+e[15]),t}function se(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,n,r){var i,a,o,s,u,c,l,h,f,m,v,p,g,_,b,w,y,M,x,T,E,R,A,k,P=r[0],S=r[1],B=r[2],F=Math.hypot(P,S,B);return F<d?null:(P*=F=1/F,S*=F,B*=F,i=Math.sin(n),o=1-(a=Math.cos(n)),s=e[0],u=e[1],c=e[2],l=e[3],h=e[4],f=e[5],m=e[6],v=e[7],p=e[8],g=e[9],_=e[10],b=e[11],w=P*P*o+a,y=S*P*o+B*i,M=B*P*o-S*i,x=P*S*o-B*i,T=S*S*o+a,E=B*S*o+P*i,R=P*B*o+S*i,A=S*B*o-P*i,k=B*B*o+a,t[0]=s*w+h*y+p*M,t[1]=u*w+f*y+g*M,t[2]=c*w+m*y+_*M,t[3]=l*w+v*y+b*M,t[4]=s*x+h*T+p*E,t[5]=u*x+f*T+g*E,t[6]=c*x+m*T+_*E,t[7]=l*x+v*T+b*E,t[8]=s*R+h*A+p*k,t[9]=u*R+f*A+g*k,t[10]=c*R+m*A+_*k,t[11]=l*R+v*A+b*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*r,t[5]=o*i+l*r,t[6]=s*i+h*r,t[7]=u*i+f*r,t[8]=c*i-a*r,t[9]=l*i-o*r,t[10]=h*i-s*r,t[11]=f*i-u*r,t}function le(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*r,t[1]=o*i-l*r,t[2]=s*i-h*r,t[3]=u*i-f*r,t[8]=a*r+c*i,t[9]=o*r+l*i,t[10]=s*r+h*i,t[11]=u*r+f*i,t}function he(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*r,t[1]=o*i+l*r,t[2]=s*i+h*r,t[3]=u*i+f*r,t[4]=c*i-a*r,t[5]=l*i-o*r,t[6]=h*i-s*r,t[7]=f*i-u*r,t}function fe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function de(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e,n){var r,i,a,o=n[0],s=n[1],u=n[2],c=Math.hypot(o,s,u);return c<d?null:(o*=c=1/c,s*=c,u*=c,r=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=o*o*a+i,t[1]=s*o*a+u*r,t[2]=u*o*a-s*r,t[3]=0,t[4]=o*s*a-u*r,t[5]=s*s*a+i,t[6]=u*s*a+o*r,t[7]=0,t[8]=o*u*a+s*r,t[9]=s*u*a-o*r,t[10]=u*u*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function ve(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pe(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _e(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,u=i+i,c=a+a,l=r*s,h=r*u,f=r*c,d=i*u,m=i*c,v=a*c,p=o*s,g=o*u,_=o*c;return t[0]=1-(d+v),t[1]=h+_,t[2]=f-g,t[3]=0,t[4]=h-_,t[5]=1-(l+v),t[6]=m+p,t[7]=0,t[8]=f+g,t[9]=m-p,t[10]=1-(l+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function be(t,e){var n=new m(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=r*r+i*i+a*a+o*o;return h>0?(n[0]=2*(s*o+l*r+u*a-c*i)/h,n[1]=2*(u*o+l*i+c*r-s*a)/h,n[2]=2*(c*o+l*a+s*i-u*r)/h):(n[0]=2*(s*o+l*r+u*a-c*i),n[1]=2*(u*o+l*i+c*r-s*a),n[2]=2*(c*o+l*a+s*i-u*r)),_e(t,e,n),t}function we(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function ye(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(u,c,l),t}function Me(t,e){var n=new m(3);ye(n,e);var r=1/n[0],i=1/n[1],a=1/n[2],o=e[0]*r,s=e[1]*i,u=e[2]*a,c=e[4]*r,l=e[5]*i,h=e[6]*a,f=e[8]*r,d=e[9]*i,v=e[10]*a,p=o+l+v,g=0;return p>0?(g=2*Math.sqrt(p+1),t[3]=.25*g,t[0]=(h-d)/g,t[1]=(f-u)/g,t[2]=(s-c)/g):o>l&&o>v?(g=2*Math.sqrt(1+o-l-v),t[3]=(h-d)/g,t[0]=.25*g,t[1]=(s+c)/g,t[2]=(f+u)/g):l>v?(g=2*Math.sqrt(1+l-o-v),t[3]=(f-u)/g,t[0]=(s+c)/g,t[1]=.25*g,t[2]=(h+d)/g):(g=2*Math.sqrt(1+v-o-l),t[3]=(s-c)/g,t[0]=(f+u)/g,t[1]=(h+d)/g,t[2]=.25*g),t}function xe(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],u=i+i,c=a+a,l=o+o,h=i*u,f=i*c,d=i*l,m=a*c,v=a*l,p=o*l,g=s*u,_=s*c,b=s*l,w=r[0],y=r[1],M=r[2];return t[0]=(1-(m+p))*w,t[1]=(f+b)*w,t[2]=(d-_)*w,t[3]=0,t[4]=(f-b)*y,t[5]=(1-(h+p))*y,t[6]=(v+g)*y,t[7]=0,t[8]=(d+_)*M,t[9]=(v-g)*M,t[10]=(1-(h+m))*M,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Te(t,e,n,r,i){var a=e[0],o=e[1],s=e[2],u=e[3],c=a+a,l=o+o,h=s+s,f=a*c,d=a*l,m=a*h,v=o*l,p=o*h,g=s*h,_=u*c,b=u*l,w=u*h,y=r[0],M=r[1],x=r[2],T=i[0],E=i[1],R=i[2],A=(1-(v+g))*y,k=(d+w)*y,P=(m-b)*y,S=(d-w)*M,B=(1-(f+g))*M,F=(p+_)*M,L=(m+b)*x,C=(p-_)*x,D=(1-(f+v))*x;return t[0]=A,t[1]=k,t[2]=P,t[3]=0,t[4]=S,t[5]=B,t[6]=F,t[7]=0,t[8]=L,t[9]=C,t[10]=D,t[11]=0,t[12]=n[0]+T-(A*T+S*E+L*R),t[13]=n[1]+E-(k*T+B*E+C*R),t[14]=n[2]+R-(P*T+F*E+D*R),t[15]=1,t}function Ee(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,u=i+i,c=n*o,l=r*o,h=r*s,f=i*o,d=i*s,m=i*u,v=a*o,p=a*s,g=a*u;return t[0]=1-h-m,t[1]=l+g,t[2]=f-p,t[3]=0,t[4]=l-g,t[5]=1-c-m,t[6]=d+v,t[7]=0,t[8]=f+p,t[9]=d-v,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Re(t,e,n,r,i,a,o){var s=1/(n-e),u=1/(i-r),c=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function Ae(t,e,n,r,i){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}function ke(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(i+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(i-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Pe(t,e,n,r,i,a,o){var s=1/(e-n),u=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(o+a)*c,t[15]=1,t}function Se(t,e,n,r){var i,a,o,s,u,c,l,h,f,m,v=e[0],p=e[1],g=e[2],_=r[0],b=r[1],w=r[2],y=n[0],M=n[1],x=n[2];return Math.abs(v-y)<d&&Math.abs(p-M)<d&&Math.abs(g-x)<d?te(t):(l=v-y,h=p-M,f=g-x,i=b*(f*=m=1/Math.hypot(l,h,f))-w*(h*=m),a=w*(l*=m)-_*f,o=_*h-b*l,(m=Math.hypot(i,a,o))?(i*=m=1/m,a*=m,o*=m):(i=0,a=0,o=0),s=h*o-f*a,u=f*i-l*o,c=l*a-h*i,(m=Math.hypot(s,u,c))?(s*=m=1/m,u*=m,c*=m):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=a,t[5]=u,t[6]=h,t[7]=0,t[8]=o,t[9]=c,t[10]=f,t[11]=0,t[12]=-(i*v+a*p+o*g),t[13]=-(s*v+u*p+c*g),t[14]=-(l*v+h*p+f*g),t[15]=1,t)}function Be(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=r[0],u=r[1],c=r[2],l=i-n[0],h=a-n[1],f=o-n[2],d=l*l+h*h+f*f;d>0&&(l*=d=1/Math.sqrt(d),h*=d,f*=d);var m=u*f-c*h,v=c*l-s*f,p=s*h-u*l;return(d=m*m+v*v+p*p)>0&&(m*=d=1/Math.sqrt(d),v*=d,p*=d),t[0]=m,t[1]=v,t[2]=p,t[3]=0,t[4]=h*p-f*v,t[5]=f*m-l*p,t[6]=l*v-h*m,t[7]=0,t[8]=l,t[9]=h,t[10]=f,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function Fe(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Le(t){return Math.hypot(t[0],t[1],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ce(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function De(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Ie(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Ne(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Ue(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Oe(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],f=t[10],m=t[11],v=t[12],p=t[13],g=t[14],_=t[15],b=e[0],w=e[1],y=e[2],M=e[3],x=e[4],T=e[5],E=e[6],R=e[7],A=e[8],k=e[9],P=e[10],S=e[11],B=e[12],F=e[13],L=e[14],C=e[15];return Math.abs(n-b)<=d*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-w)<=d*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(i-y)<=d*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(a-M)<=d*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(o-x)<=d*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-T)<=d*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(u-E)<=d*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-R)<=d*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(l-A)<=d*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(h-k)<=d*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(f-P)<=d*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(m-S)<=d*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(v-B)<=d*Math.max(1,Math.abs(v),Math.abs(B))&&Math.abs(p-F)<=d*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(g-L)<=d*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(_-C)<=d*Math.max(1,Math.abs(_),Math.abs(C))}var Ge=ae,ze=De;function Ve(){var t=new m(3);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function je(t){var e=new m(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function qe(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function He(t,e,n){var r=new m(3);return r[0]=t,r[1]=e,r[2]=n,r}function We(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ke(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Ze(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Xe(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ye(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function $e(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Qe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Je(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function en(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function nn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function rn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function an(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function on(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function sn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function un(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function cn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function ln(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function hn(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function fn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function dn(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],u=n[2];return t[0]=i*u-a*s,t[1]=a*o-r*u,t[2]=r*s-i*o,t}function mn(t,e,n,r){var i=e[0],a=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t}function vn(t,e,n,r,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,c=o*(a-1),l=o*(3-2*a);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*l,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*l,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*l,t}function pn(t,e,n,r,i,a){var o=1-a,s=o*o,u=a*a,c=s*o,l=3*a*s,h=3*u*o,f=u*a;return t[0]=e[0]*c+n[0]*l+r[0]*h+i[0]*f,t[1]=e[1]*c+n[1]*l+r[1]*h+i[1]*f,t[2]=e[2]*c+n[2]*l+r[2]*h+i[2]*f,t}function gn(t,e){e=e||1;var n=2*v()*Math.PI,r=2*v()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function _n(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function bn(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function wn(t,e,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=e[0],u=e[1],c=e[2],l=i*c-a*u,h=a*s-r*c,f=r*u-i*s,d=i*f-a*h,m=a*l-r*f,v=r*h-i*l,p=2*o;return l*=p,h*=p,f*=p,d*=2,m*=2,v*=2,t[0]=s+l+d,t[1]=u+h+m,t[2]=c+f+v,t}function yn(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Mn(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function xn(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Tn(t,e){var n=He(t[0],t[1],t[2]),r=He(e[0],e[1],e[2]);hn(n,n),hn(r,r);var i=fn(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}function En(t){return t[0]=0,t[1]=0,t[2]=0,t}function Rn(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function An(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function kn(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))}var Pn,Sn=Xe,Bn=Ye,Fn=$e,Ln=on,Cn=sn,Dn=qe,In=un,Nn=(Pn=Ve(),function(t,e,n,r,i,a){var o,s;for(e||(e=3),n||(n=0),s=r?Math.min(r*e+n,t.length):t.length,o=n;o<s;o+=e)Pn[0]=t[o],Pn[1]=t[o+1],Pn[2]=t[o+2],i(Pn,Pn,a),t[o]=Pn[0],t[o+1]=Pn[1],t[o+2]=Pn[2];return t});function Un(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function On(t){var e=new m(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Gn(t,e,n,r){var i=new m(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function zn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Vn(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function jn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function qn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Hn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Wn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Kn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Zn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Xn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Yn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function $n(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Qn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Jn(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function tr(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.hypot(n,r,i,a)}function er(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return n*n+r*r+i*i+a*a}function nr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function rr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function ir(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function ar(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function or(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o,t}function sr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ur(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],a=n[0]*r[2]-n[2]*r[0],o=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],l=e[0],h=e[1],f=e[2],d=e[3];return t[0]=h*c-f*u+d*s,t[1]=-l*c+f*o-d*a,t[2]=l*u-h*o+d*i,t[3]=-l*s+h*a-f*i,t}function cr(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t[3]=s+r*(n[3]-s),t}function lr(t,e){var n,r,i,a,o,s;e=e||1;do{o=(n=2*v()-1)*n+(r=2*v()-1)*r}while(o>=1);do{s=(i=2*v()-1)*i+(a=2*v()-1)*a}while(s>=1);var u=Math.sqrt((1-o)/s);return t[0]=e*n,t[1]=e*r,t[2]=e*i*u,t[3]=e*a*u,t}function hr(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t}function fr(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*a-u*i,h=c*i+u*r-o*a,f=c*a+o*i-s*r,d=-o*r-s*i-u*a;return t[0]=l*c+d*-o+h*-u-f*-s,t[1]=h*c+d*-s+f*-o-l*-u,t[2]=f*c+d*-u+l*-s-h*-o,t[3]=e[3],t}function dr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function mr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function vr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function pr(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=d*Math.max(1,Math.abs(a),Math.abs(c))}var gr=qn,_r=Hn,br=Wn,wr=tr,yr=er,Mr=nr,xr=rr,Tr=function(){var t=Un();return function(e,n,r,i,a,o){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function Er(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Rr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ar(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function kr(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>d?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Pr(t,e){var n=ii(t,e);return Math.acos(2*n*n-1)}function Sr(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+o*s+i*c-a*u,t[1]=i*l+o*u+a*s-r*c,t[2]=a*l+o*c+r*u-i*s,t[3]=o*l-r*s-i*u-a*c,t}function Br(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=a*u-i*s,t[3]=o*u-r*s,t}function Fr(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-a*s,t[1]=i*u+o*s,t[2]=a*u+r*s,t[3]=o*u-i*s,t}function Lr(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=a*u+o*s,t[3]=o*u-a*s,t}function Cr(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Dr(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(n*n+r*r+i*i),s=Math.exp(a),u=o>0?s*Math.sin(o)/o:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=s*Math.cos(o),t}function Ir(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(n*n+r*r+i*i),s=o>0?Math.atan2(o,a)/o:0;return t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=.5*Math.log(n*n+r*r+i*i+a*a),t}function Nr(t,e,n){return Ir(t,e),ri(t,t,n),Dr(t,t),t}function Ur(t,e,n,r){var i,a,o,s,u,c=e[0],l=e[1],h=e[2],f=e[3],m=n[0],v=n[1],p=n[2],g=n[3];return(a=c*m+l*v+h*p+f*g)<0&&(a=-a,m=-m,v=-v,p=-p,g=-g),1-a>d?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,u=Math.sin(r*i)/o):(s=1-r,u=r),t[0]=s*c+u*m,t[1]=s*l+u*v,t[2]=s*h+u*p,t[3]=s*f+u*g,t}function Or(t){var e=v(),n=v(),r=v(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t}function Gr(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=a*s,t}function zr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Vr(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*o+o]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*a+o]-e[3*o+a])*n,t[a]=(e[3*a+i]+e[3*i+a])*n,t[o]=(e[3*o+i]+e[3*i+o])*n}return t}function jr(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),l=Math.cos(r);return t[0]=a*u*l-o*s*c,t[1]=o*s*l+a*u*c,t[2]=o*u*c-a*s*l,t[3]=o*u*l+a*s*c,t}function qr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Hr,Wr,Kr,Zr,Xr,Yr,$r=On,Qr=Gn,Jr=zn,ti=Vn,ei=jn,ni=Sr,ri=Qn,ii=sr,ai=cr,oi=nr,si=oi,ui=rr,ci=ui,li=or,hi=vr,fi=pr,di=(Hr=Ve(),Wr=He(1,0,0),Kr=He(0,1,0),function(t,e,n){var r=fn(e,n);return r<-.999999?(dn(Hr,Wr,e),Dn(Hr)<1e-6&&dn(Hr,Kr,e),hn(Hr,Hr),Ar(t,Hr,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(dn(Hr,e,n),t[0]=Hr[0],t[1]=Hr[1],t[2]=Hr[2],t[3]=1+r,li(t,t))}),mi=(Zr=Er(),Xr=Er(),function(t,e,n,r,i,a){return Ur(Zr,e,i,a),Ur(Xr,n,r,a),Ur(t,Zr,Xr,2*a*(1-a)),t}),vi=(Yr=gt(),function(t,e,n,r){return Yr[0]=n[0],Yr[3]=n[1],Yr[6]=n[2],Yr[1]=r[0],Yr[4]=r[1],Yr[7]=r[2],Yr[2]=-e[0],Yr[5]=-e[1],Yr[8]=-e[2],li(t,Vr(t,Yr))});function pi(){var t=new m(8);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function gi(t){var e=new m(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function _i(t,e,n,r,i,a,o,s){var u=new m(8);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=i,u[5]=a,u[6]=o,u[7]=s,u}function bi(t,e,n,r,i,a,o){var s=new m(8);s[0]=t,s[1]=e,s[2]=n,s[3]=r;var u=.5*i,c=.5*a,l=.5*o;return s[4]=u*r+c*n-l*e,s[5]=c*r+l*t-u*n,s[6]=l*r+u*e-c*t,s[7]=-u*t-c*e-l*n,s}function wi(t,e,n){var r=.5*n[0],i=.5*n[1],a=.5*n[2],o=e[0],s=e[1],u=e[2],c=e[3];return t[0]=o,t[1]=s,t[2]=u,t[3]=c,t[4]=r*c+i*u-a*s,t[5]=i*c+a*o-r*u,t[6]=a*c+r*s-i*o,t[7]=-r*o-i*s-a*u,t}function yi(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function Mi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function xi(t,e){var n=Er();Me(n,e);var r=new m(3);return we(r,e),wi(t,n,r),t}function Ti(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Ei(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Ri(t,e,n,r,i,a,o,s,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t}var Ai=Jr;function ki(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Pi=Jr;function Si(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Bi(t,e){var n=e[4],r=e[5],i=e[6],a=e[7],o=-e[0],s=-e[1],u=-e[2],c=e[3];return t[0]=2*(n*c+a*o+r*u-i*s),t[1]=2*(r*c+a*s+i*o-n*u),t[2]=2*(i*c+a*u+n*s-r*o),t}function Fi(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=.5*n[0],u=.5*n[1],c=.5*n[2],l=e[4],h=e[5],f=e[6],d=e[7];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=o*s+i*c-a*u+l,t[5]=o*u+a*s-r*c+h,t[6]=o*c+r*u-i*s+f,t[7]=-r*s-i*u-a*c+d,t}function Li(t,e,n){var r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=s*o+l*r+u*a-c*i,f=u*o+l*i+c*r-s*a,d=c*o+l*a+s*i-u*r,m=l*o-s*r-u*i-c*a;return Br(t,e,n),r=t[0],i=t[1],a=t[2],o=t[3],t[4]=h*o+m*r+f*a-d*i,t[5]=f*o+m*i+d*r-h*a,t[6]=d*o+m*a+h*i-f*r,t[7]=m*o-h*r-f*i-d*a,t}function Ci(t,e,n){var r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=s*o+l*r+u*a-c*i,f=u*o+l*i+c*r-s*a,d=c*o+l*a+s*i-u*r,m=l*o-s*r-u*i-c*a;return Fr(t,e,n),r=t[0],i=t[1],a=t[2],o=t[3],t[4]=h*o+m*r+f*a-d*i,t[5]=f*o+m*i+d*r-h*a,t[6]=d*o+m*a+h*i-f*r,t[7]=m*o-h*r-f*i-d*a,t}function Di(t,e,n){var r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=s*o+l*r+u*a-c*i,f=u*o+l*i+c*r-s*a,d=c*o+l*a+s*i-u*r,m=l*o-s*r-u*i-c*a;return Lr(t,e,n),r=t[0],i=t[1],a=t[2],o=t[3],t[4]=h*o+m*r+f*a-d*i,t[5]=f*o+m*i+d*r-h*a,t[6]=d*o+m*a+h*i-f*r,t[7]=m*o-h*r-f*i-d*a,t}function Ii(t,e,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=e[0],u=e[1],c=e[2],l=e[3];return t[0]=s*o+l*r+u*a-c*i,t[1]=u*o+l*i+c*r-s*a,t[2]=c*o+l*a+s*i-u*r,t[3]=l*o-s*r-u*i-c*a,s=e[4],u=e[5],c=e[6],l=e[7],t[4]=s*o+l*r+u*a-c*i,t[5]=u*o+l*i+c*r-s*a,t[6]=c*o+l*a+s*i-u*r,t[7]=l*o-s*r-u*i-c*a,t}function Ni(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+o*s+i*c-a*u,t[1]=i*l+o*u+a*s-r*c,t[2]=a*l+o*c+r*u-i*s,t[3]=o*l-r*s-i*u-a*c,s=n[4],u=n[5],c=n[6],l=n[7],t[4]=r*l+o*s+i*c-a*u,t[5]=i*l+o*u+a*s-r*c,t[6]=a*l+o*c+r*u-i*s,t[7]=o*l-r*s-i*u-a*c,t}function Ui(t,e,n,r){if(Math.abs(r)<d)return Ti(t,e);var i=Math.hypot(n[0],n[1],n[2]);r*=.5;var a=Math.sin(r),o=a*n[0]/i,s=a*n[1]/i,u=a*n[2]/i,c=Math.cos(r),l=e[0],h=e[1],f=e[2],m=e[3];t[0]=l*c+m*o+h*u-f*s,t[1]=h*c+m*s+f*o-l*u,t[2]=f*c+m*u+l*s-h*o,t[3]=m*c-l*o-h*s-f*u;var v=e[4],p=e[5],g=e[6],_=e[7];return t[4]=v*c+_*o+p*u-g*s,t[5]=p*c+_*s+g*o-v*u,t[6]=g*c+_*u+v*s-p*o,t[7]=_*c-v*o-p*s-g*u,t}function Oi(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Gi(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[4],u=n[5],c=n[6],l=n[7],h=e[4],f=e[5],d=e[6],m=e[7],v=n[0],p=n[1],g=n[2],_=n[3];return t[0]=r*_+o*v+i*g-a*p,t[1]=i*_+o*p+a*v-r*g,t[2]=a*_+o*g+r*p-i*v,t[3]=o*_-r*v-i*p-a*g,t[4]=r*l+o*s+i*c-a*u+h*_+m*v+f*g-d*p,t[5]=i*l+o*u+a*s-r*c+f*_+m*p+d*v-h*g,t[6]=a*l+o*c+r*u-i*s+d*_+m*g+h*p-f*v,t[7]=o*l-r*s-i*u-a*c+m*_-h*v-f*p-d*g,t}var zi=Gi;function Vi(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var ji=ii;function qi(t,e,n,r){var i=1-r;return ji(e,n)<0&&(r=-r),t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t[4]=e[4]*i+n[4]*r,t[5]=e[5]*i+n[5]*r,t[6]=e[6]*i+n[6]*r,t[7]=e[7]*i+n[7]*r,t}function Hi(t,e){var n=Xi(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function Wi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Ki=oi,Zi=Ki,Xi=ui,Yi=Xi;function $i(t,e){var n=Xi(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,i=e[1]/n,a=e[2]/n,o=e[3]/n,s=e[4],u=e[5],c=e[6],l=e[7],h=r*s+i*u+a*c+o*l;t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=(s-r*h)/n,t[5]=(u-i*h)/n,t[6]=(c-a*h)/n,t[7]=(l-o*h)/n}return t}function Qi(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Ji(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function ta(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],l=e[0],h=e[1],f=e[2],m=e[3],v=e[4],p=e[5],g=e[6],_=e[7];return Math.abs(n-l)<=d*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-h)<=d*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-f)<=d*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(a-m)<=d*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(o-v)<=d*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(s-p)<=d*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(u-g)<=d*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-_)<=d*Math.max(1,Math.abs(c),Math.abs(_))}function ea(){var t=new m(2);return m!=Float32Array&&(t[0]=0,t[1]=0),t}function na(t){var e=new m(2);return e[0]=t[0],e[1]=t[1],e}function ra(t,e){var n=new m(2);return n[0]=t,n[1]=e,n}function ia(t,e){return t[0]=e[0],t[1]=e[1],t}function aa(t,e,n){return t[0]=e,t[1]=n,t}function oa(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function sa(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function ua(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function ca(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function la(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function ha(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function fa(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function da(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function ma(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function va(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function pa(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function ga(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function _a(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function ba(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function wa(t){var e=t[0],n=t[1];return e*e+n*n}function ya(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Ma(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function xa(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function Ta(t,e){return t[0]*e[0]+t[1]*e[1]}function Ea(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function Ra(t,e,n,r){var i=e[0],a=e[1];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t}function Aa(t,e){e=e||1;var n=2*v()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function ka(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function Pa(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function Sa(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function Ba(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function Fa(t,e,n,r){var i=e[0]-n[0],a=e[1]-n[1],o=Math.sin(r),s=Math.cos(r);return t[0]=i*s-a*o+n[0],t[1]=i*o+a*s+n[1],t}function La(t,e){var n=t[0],r=t[1],i=e[0],a=e[1],o=n*n+r*r;o>0&&(o=1/Math.sqrt(o));var s=i*i+a*a;s>0&&(s=1/Math.sqrt(s));var u=(n*i+r*a)*o*s;return u>1?0:u<-1?Math.PI:Math.acos(u)}function Ca(t){return t[0]=0,t[1]=0,t}function Da(t){return"vec2("+t[0]+", "+t[1]+")"}function Ia(t,e){return t[0]===e[0]&&t[1]===e[1]}function Na(t,e){var n=t[0],r=t[1],i=e[0],a=e[1];return Math.abs(n-i)<=d*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))}var Ua=ba,Oa=sa,Ga=ua,za=ca,Va=ga,ja=_a,qa=wa,Ha=function(){var t=ea();return function(e,n,r,i,a,o){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}();n.d(e,"glMatrix",(function(){return r})),n.d(e,"mat2",(function(){return i})),n.d(e,"mat2d",(function(){return a})),n.d(e,"mat3",(function(){return o})),n.d(e,"mat4",(function(){return s})),n.d(e,"quat",(function(){return l})),n.d(e,"quat2",(function(){return h})),n.d(e,"vec2",(function(){return f})),n.d(e,"vec3",(function(){return u})),n.d(e,"vec4",(function(){return c}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(5),a=n(2);function o(t,e){return"number"==typeof t?[e,t,!0]:"number"==typeof e?[t,e,!1]:e.length>t.length?[e,t,!0]:[t,e,!1]}Number.prototype.__to=function(t){switch(t){case i.Vector4:return i.vec4(this.valueOf(),this.valueOf(),this.valueOf(),this.valueOf());case r.Vector3:return r.vec3(this.valueOf(),this.valueOf(),this.valueOf());case a.Vector2:return a.vec2(this.valueOf(),this.valueOf())}return this.valueOf()},e.plus=function(t,e){const[n,r]=o(t,e);return r.__to(n.constructor).plus(n)},e.minus=function(t,e){const[n,r,i]=o(t,e);return i?r.__to(n.constructor).minus(n):r.__to(n.constructor).minus(n).negate()},e.mul=function(t,e){const[n,r]=o(t,e);return r.__to(n.constructor).mul(n)},e.div=function(t,e){const[n,r,i]=o(t,e);return i?r.__to(n.constructor).div(n):r.__to(n.constructor).div(n).inversed},e.dot=function(t,e){return t.dot(e)},e.cross=function(t,e){return t.cross(e)},e.Deg2Rad=Math.PI/180,e.Rad2Deg=180/Math.PI},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.EventEmitter=class{constructor(){this.listeners=new Map}on(t,e){var n;this.listeners.has(t)||this.listeners.set(t,[]),null===(n=this.listeners.get(t))||void 0===n||n.push(e)}off(t,e){var n,r;this.listeners.has(t)&&this.listeners.set(t,null!=(r=null===(n=this.listeners.get(t))||void 0===n?void 0:n.filter(t=>t!==e))?r:[])}emit(t,...e){var n;null===(n=this.listeners.get(t))||void 0===n||n.forEach(t=>t(...e))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(33),i=n(7),a=n(11);class o extends r.Transform{constructor(){super(...arguments),this.assetID=i.AssetManager.newAssetID(this),this.name=`Entity_${this.assetID}`,this.eventEmitter=new a.EventEmitter,this.destroyed=!1}on(t,e){return this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}__updateRecursive(t){this.eventEmitter.emit("update",this,t);for(const e of this.children)e.__updateRecursive(t)}destroy(){this.destroyed=!0,i.AssetManager.destroy(this.assetID)}}e.Entity=o;e.EntityManager=class{constructor(){this.entityMap=new Map,this._entities=[]}get entities(){return this._entities}add(t){this.entityMap.set(t.assetID,t),this._entities=Array.from(this.entityMap.values())}removeRecursive(t){this.entityMap.delete(t.assetID);for(const e of t.children)this.removeRecursive(e)}remove(t){this.removeRecursive(t),t.parent&&t.parent.children.delete(t),this._entities=Array.from(this.entityMap.values())}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(18),a=n(3),o=n(7);var s,u;!function(t){t[t.Linear=WebGL2RenderingContext.LINEAR]="Linear",t[t.Nearest=WebGL2RenderingContext.NEAREST]="Nearest"}(s=e.FilterMode||(e.FilterMode={})),function(t){t[t.Repeat=WebGL2RenderingContext.REPEAT]="Repeat",t[t.Clamp=WebGL2RenderingContext.CLAMP_TO_EDGE]="Clamp",t[t.Mirror=WebGL2RenderingContext.MIRRORED_REPEAT]="Mirror"}(u=e.WrapMode||(e.WrapMode={}));class c extends o.Asset{}e.Texture=c;class l extends o.Asset{constructor(t,e,n=i.TextureFormat.RGBA,o=s.Linear,c=r.GlobalContext()){var l;super(),this.mipmapLevel=0,this.wrapMode=u.Repeat,this.name=`Texture_${this.assetID}`;const h=c.gl;this.ctx=c,this.format=n,this.width=t,this.height=e,this.filterMode=o,this.glTex=null!=(l=h.createTexture())?l:a.panic("Failed to create texture.")}setup(){const t=this.ctx.gl;t.bindTexture(t.TEXTURE_2D,this.glTex),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.filterMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.filterMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapMode)}bind(t,e){const n=e.gl;n.activeTexture(n.TEXTURE0+e.nextTextureUnit),n.bindTexture(n.TEXTURE_2D,this.glTex),n.uniform1i(t,e.nextTextureUnit),e.nextTextureUnit++}destroy(){if(this.destroyed)return;this.ctx.gl.deleteTexture(this.glTex),super.destroy()}}e.Texture2D=class extends l{constructor(t=0,e=0,n=i.TextureFormat.RGBA,a=s.Linear,o=r.GlobalContext()){super(t,e,n,a,o)}setData(t){super.setup();const e=this.ctx.gl,[n,r,a]=i.mapGLFormat(e,this.format);void 0!==t.width&&void 0!==t.height?(t=t,this.width=t.width,this.height=t.height,e.texImage2D(e.TEXTURE_2D,this.mipmapLevel,n,this.width,this.height,0,r,a,null)):e.texImage2D(e.TEXTURE_2D,this.mipmapLevel,n,this.width,this.height,0,r,a,null),f(this.ctx,this.glTex,t,this.width,this.height,this.format,this.filterMode,this.wrapMode,this.mipmapLevel)}};class h extends l{constructor(t,e,n=r.GlobalContext()){super(t,e,i.TextureFormat.DEPTH_COMPONENT,s.Nearest,n)}create(){super.setup();const t=this.ctx.gl;t.bindTexture(t.TEXTURE_2D,this.glTex);const[e,n,r]=i.mapGLFormat(t,i.TextureFormat.DEPTH_COMPONENT);t.texImage2D(t.TEXTURE_2D,this.mipmapLevel,e,this.width,this.height,0,n,r,null)}}e.DepthTexture=h;function f(t,e,n,r,o,s,u,c,l){var h,f;const d=t.gl,m=null!=(h=d.createTexture())?h:a.panic("Failed to create texture."),[v,p,g]=i.mapGLFormat(d,s);d.bindTexture(d.TEXTURE_2D,m),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,c),void 0!==n.width&&void 0!==n.height?(n=n,d.texImage2D(d.TEXTURE_2D,l,v,p,g,n)):(n=n,d.texImage2D(d.TEXTURE_2D,l,v,r,o,0,p,g,n));const _=null!=(f=d.createFramebuffer())?f:a.panic("Failed to create frame buffer");d.bindFramebuffer(d.FRAMEBUFFER,_),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,e,0),d.viewport(0,0,r,o),d.drawBuffers([d.COLOR_ATTACHMENT0]);const b=t.assets.shaders.FlipTexture;d.useProgram(b.program),d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,m),d.uniform1i(b.builtinUniformLocations.mainTex,0);const w=t.assets.meshes.screenQuad;w.bind(b,d),d.drawElements(d.TRIANGLE_STRIP,w.triangles.length,d.UNSIGNED_INT,0),d.deleteFramebuffer(_),d.bindFramebuffer(d.FRAMEBUFFER,null),d.deleteTexture(m)}e.RenderTexture=class extends l{constructor(t,e,n,a=i.TextureFormat.RGBA,o=s.Linear,u=r.GlobalContext()){super(t,e,a,o,u),this.depthTexture=null,n&&(this.depthTexture=new h(t,e,u)),this.update()}update(){super.setup();const t=this.ctx.gl,[e,n,r]=i.mapGLFormat(t,this.format);t.texImage2D(t.TEXTURE_2D,this.mipmapLevel,e,this.width,this.height,0,n,r,null)}setData(t){const e=this.ctx.gl;e.bindTexture(e.TEXTURE_2D,this.glTex);const[n,r,a]=i.mapGLFormat(e,this.format);e.texImage2D(e.TEXTURE_2D,this.mipmapLevel,n,this.width,this.height,0,r,a,null),f(this.ctx,this.glTex,t,this.width,this.height,this.format,this.filterMode,this.wrapMode,this.mipmapLevel)}destroy(){var t;this.destroyed||(null===(t=this.depthTexture)||void 0===t||t.destroy(),super.destroy())}}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(20)),r(n(27)),r(n(15)),r(n(48)),r(n(22)),r(n(13)),r(n(7)),r(n(30)),r(n(11))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(2),a=n(4),o=n(1),s=n(3),u=n(10),c=n(7);class l extends c.Asset{constructor(t=o.GL()){var e,n;super(),this._verts=[],this._triangles=[],this._uvs=[],this._colors=[],this._normals=[],this.dirty=!0,this.uploaded=!1,this.vertices=new Float32Array(0),this.indices=new Uint32Array(0),this.name=`Mesh_${this.assetID}`,this.gl=t,this.VBO=null!=(e=t.createBuffer())?e:s.panic("Failed to create vertex buffer."),this.EBO=null!=(n=t.createBuffer())?n:s.panic("Failed to create element buffer.")}get verts(){return this._verts}set verts(t){this._verts=t,this.dirty=!0}get triangles(){return this._triangles}set triangles(t){this._triangles=t,this.dirty=!0}get uvs(){return this._uvs}set uvs(t){this._uvs=t,this.dirty=!0}get colors(){return this._colors}set colors(t){this._colors=t,this.dirty=!0}get normals(){return this._normals}set normals(t){this._normals=t,this.dirty=!0}clear(){this.verts=[],this.uvs=[],this.triangles=[],this.colors=[],this.normals=[]}calculateNormals(t=0){if(this.triangles.length%3!=0)throw new Error("Invalid triangles.");this.normals=s.fillArray(()=>r.vec3(0,0,0),this.verts.length);for(let t=0;t<this.triangles.length;t+=3){const e=this.verts[this.triangles[t]],n=this.verts[this.triangles[t+1]],r=this.verts[this.triangles[t+2]],i=u.minus(n,e),a=u.minus(r,e),o=u.cross(i,a).normalize();this.normals[this.triangles[t+0]].plus(o),this.normals[this.triangles[t+1]].plus(o),this.normals[this.triangles[t+2]].plus(o)}for(let t=0;t<this.normals.length;t++)this.normals[t]=this.normals[t].normalize()}update(){if(this.dirty){if(this.triangles.length%3!=0)throw new Error("Invalid triangles.");if(this.colors.length!==this.verts.length&&(this.colors=[...this.colors,...s.fillArray(a.Color.white,this.verts.length-this.colors.length)]),this.uvs.length!==this.verts.length&&(this.uvs=[...this.uvs,...s.fillArray(i.vec2(0,0),this.verts.length-this.uvs.length)]),this.normals.length!==this.verts.length&&(this.normals=[...this.normals,...s.fillArray(r.vec3(0,0,0),this.verts.length-this.normals.length)]),this.vertices=new Float32Array(this.verts.flatMap((t,e)=>[...t,...this.colors[e],...this.uvs[e],...this.normals[e]])),this.vertices.length!=12*this.verts.length)throw new Error("Buffer with invalid length.");this.indices=new Uint32Array(this.triangles.flat()),this.dirty=!1,this.uploaded=!1}}setup(t){return this.update(),this.uploaded||(t.bindBuffer(t.ARRAY_BUFFER,this.VBO),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.EBO),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.uploaded=!0),[this.VBO,this.EBO]}bind(t,e){this.setup(e);const n=t.attributes;e.bindBuffer(e.ARRAY_BUFFER,this.VBO),n.vert>=0&&(e.vertexAttribPointer(n.vert,3,e.FLOAT,!1,48,0),e.enableVertexAttribArray(n.vert)),n.color>=0&&(e.vertexAttribPointer(n.color,4,e.FLOAT,!1,48,12),e.enableVertexAttribArray(n.color)),n.uv>=0&&(e.vertexAttribPointer(n.uv,2,e.FLOAT,!1,48,28),e.enableVertexAttribArray(n.uv)),n.normal>=0&&(e.vertexAttribPointer(n.normal,3,e.FLOAT,!0,48,36),e.enableVertexAttribArray(n.normal)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.EBO)}destroy(){this.destroyed||(this.gl.deleteBuffer(this.VBO),this.gl.deleteBuffer(this.EBO),super.destroy())}}e.Mesh=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9);e.mulPoint=function(t,e,n){let[i,a,o]=n;const s=r.vec4.fromValues(i,a,o,1);return[i,a,o]=r.vec4.transformMat4(r.vec4.create(),s,e),r.vec3.set(t,i,a,o),t},e.mulVector=function(t,e,n){let[i,a,o]=n;const s=r.vec4.fromValues(i,a,o,0);return[i,a,o]=r.vec4.transformMat4(r.vec4.create(),s,e),r.vec3.set(t,i,a,o),t},e.readBlob=async function(t){return new Promise((e,n)=>{const r=new FileReader;r.addEventListener("loadend",()=>{e(r.result)}),r.addEventListener("error",t=>{n(r.error)}),r.readAsArrayBuffer(t)})},e.readString=function(t,e,n){const r=t.slice(e,e+n);return(new TextDecoder).decode(r)},e.assert=function(t,e){if(!t)throw new Error(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(3),a={canvasOutput:{tex:null,attachPoint:WebGL2RenderingContext.BACK},fromRenderTexture:t=>({tex:t.glTex})};class o{constructor(t=0,e=0,n=r.GlobalContext()){var o;this.colorAttachments=[],this.depthAttachment=a.canvasOutput,this.isCanvasTarget=!0,this.width=t,this.height=e,this.frameBuffer=n?null!=(o=n.gl.createFramebuffer())?o:i.panic("Failed to create frame buffer"):null}addColorAttachment(t){if(null!==t){if(this.isCanvasTarget=!1,0==this.width&&0==this.height&&(this.width=t.width,this.height=t.height),this.width!=t.width||this.height!=t.height)throw new Error("Framebuffer attachments must in same resolution.");this.colorAttachments.push(a.fromRenderTexture(t))}}setDepthAttachment(t){var e,n;if(0==this.width&&0==this.height&&(this.width=t.width,this.height=t.height),this.width!=t.width||this.height!=t.height)throw new Error("Framebuffer attachments must in same resolution.");this.depthAttachment={tex:(n=null===(e=t)||void 0===e?void 0:e.glTex,null!=n?n:null),attachPoint:WebGL2RenderingContext.DEPTH_ATTACHMENT}}bind(t=r.GlobalContext()){const e=t.gl;if(this.isCanvasTarget)e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,t.width,t.height);else{e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer);let t=0;for(let n=0;n<this.colorAttachments.length;n++)this.colorAttachments[n].tex&&(this.colorAttachments[n].attachPoint=e.COLOR_ATTACHMENT0+t++,e.framebufferTexture2D(e.FRAMEBUFFER,this.colorAttachments[n].attachPoint,e.TEXTURE_2D,this.colorAttachments[n].tex,0));e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this.depthAttachment.tex,0),e.viewport(0,0,this.width,this.height);const n=this.colorAttachments.map(t=>t.attachPoint);e.drawBuffers(n)}}release(t=r.GlobalContext()){if(this.isCanvasTarget)return;t.gl.deleteFramebuffer(this.frameBuffer)}}e.RenderTarget=o,o.CanvasTarget=Object.freeze(new o)},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.RGB=1]="RGB",t[t.RGBA=2]="RGBA",t[t.LUMINANCE_ALPHA=3]="LUMINANCE_ALPHA",t[t.LUMINANCE=4]="LUMINANCE",t[t.ALPHA=5]="ALPHA",t[t.R8=6]="R8",t[t.R16F=7]="R16F",t[t.R32F=8]="R32F",t[t.R8UI=9]="R8UI",t[t.RG8=10]="RG8",t[t.RG16F=11]="RG16F",t[t.RG32F=12]="RG32F",t[t.RG8UI=13]="RG8UI",t[t.RGB8=14]="RGB8",t[t.SRGB8=15]="SRGB8",t[t.RGB565=16]="RGB565",t[t.R11F_G11F_B10F=17]="R11F_G11F_B10F",t[t.RGB9_E5=18]="RGB9_E5",t[t.RGB16F=19]="RGB16F",t[t.RGB32F=20]="RGB32F",t[t.RGB8UI=21]="RGB8UI",t[t.RGBA8=22]="RGBA8",t[t.SRGB8_ALPHA8=23]="SRGB8_ALPHA8",t[t.RGB5_A1=24]="RGB5_A1",t[t.RGB10_A2=25]="RGB10_A2",t[t.RGBA4=26]="RGBA4",t[t.RGBA16F=27]="RGBA16F",t[t.RGBA32F=28]="RGBA32F",t[t.RGBA8UI=29]="RGBA8UI",t[t.DEPTH_COMPONENT=30]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=31]="DEPTH_STENCIL"}(r=e.TextureFormat||(e.TextureFormat={})),e.mapGLFormat=function(t,e){return{[r.RGB]:[t.RGB,t.RGB,t.UNSIGNED_BYTE],[r.RGBA]:[t.RGBA,t.RGBA,t.UNSIGNED_BYTE],[r.LUMINANCE_ALPHA]:[t.LUMINANCE_ALPHA,t.LUMINANCE_ALPHA,t.UNSIGNED_BYTE],[r.LUMINANCE]:[t.LUMINANCE,t.LUMINANCE,t.UNSIGNED_BYTE],[r.ALPHA]:[t.ALPHA,t.ALPHA,t.UNSIGNED_BYTE],[r.R8]:[t.R8,t.RED,t.UNSIGNED_BYTE],[r.R16F]:[t.R16F,t.RED,t.HALF_FLOAT],[r.R32F]:[t.R32F,t.RED,t.FLOAT],[r.R8UI]:[t.R8UI,t.RED_INTEGER,t.UNSIGNED_BYTE],[r.RG8]:[t.RG8,t.RG,t.UNSIGNED_BYTE],[r.RG16F]:[t.RG16F,t.RG,t.HALF_FLOAT],[r.RG32F]:[t.RG32F,t.RG,t.FLOAT],[r.RG8UI]:[t.RG8UI,t.RG_INTEGER,t.UNSIGNED_BYTE],[r.RGB8]:[t.RGB8,t.RGB,t.UNSIGNED_BYTE],[r.SRGB8]:[t.SRGB8,t.RGB,t.UNSIGNED_BYTE],[r.RGB565]:[t.RGB565,t.RGB,t.UNSIGNED_BYTE],[r.R11F_G11F_B10F]:[t.R11F_G11F_B10F,t.RGB,t.UNSIGNED_INT_10F_11F_11F_REV],[r.RGB9_E5]:[t.RGB9_E5,t.RGB,t.HALF_FLOAT],[r.RGB16F]:[t.RGB16F,t.RGB,t.HALF_FLOAT],[r.RGB32F]:[t.RGB32F,t.RGB,t.FLOAT],[r.RGB8UI]:[t.RGB8UI,t.RGB_INTEGER,t.UNSIGNED_BYTE],[r.RGBA8]:[t.RGBA8,t.RGBA,t.UNSIGNED_BYTE],[r.SRGB8_ALPHA8]:[t.SRGB8_ALPHA8,t.RGBA,t.UNSIGNED_BYTE],[r.RGB5_A1]:[t.RGB5_A1,t.RGBA,t.UNSIGNED_BYTE],[r.RGB10_A2]:[t.RGB10_A2,t.RGBA,t.UNSIGNED_INT_2_10_10_10_REV],[r.RGBA4]:[t.RGBA4,t.RGBA,t.UNSIGNED_BYTE],[r.RGBA16F]:[t.RGBA16F,t.RGBA,t.HALF_FLOAT],[r.RGBA32F]:[t.RGBA32F,t.RGBA,t.FLOAT],[r.RGBA8UI]:[t.RGBA8UI,t.RGBA_INTEGER,t.UNSIGNED_BYTE],[r.DEPTH_COMPONENT]:[t.DEPTH_COMPONENT,t.DEPTH_COMPONENT,t.UNSIGNED_INT],[r.DEPTH_STENCIL]:[t.DEPTH_STENCIL,t.DEPTH_COMPONENT,t.UNSIGNED_INT]}[e]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9),i=n(0),a=n(10);function o(){return r.quat.create()}e.Quaternion=o,o.identity=()=>{const t=r.quat.create();return r.quat.identity(t),t},o.axis=(t,e)=>r.quat.setAxisAngle(r.quat.create(),t,e),o.mul=(t,e)=>{const n=r.quat.create();return r.quat.mul(n,t,e)},o.invert=t=>{const e=r.quat.create();return r.quat.invert(e,t)},o.normalize=t=>r.quat.normalize(r.quat.create(),t),o.euler=t=>i.vec3(Math.atan2(2*(t[3]*t[0]+t[1]*t[2]),1-2*(t[0]**2+t[1]**2))*a.Rad2Deg,Math.asin(2*(t[3]*t[1]-t[2]*t[0]))*a.Rad2Deg,Math.atan2(2*(t[3]*t[2]+t[0]*t[1]),1-2*(t[1],t[2]**2))*a.Rad2Deg),o.fromEuler=t=>r.quat.fromEuler(r.quat.create(),t[0],t[1],t[2]),o.rotate=(t,e)=>r.vec3.transformQuat(i.vec3(0,0,0),e,t),e.quat=o,e.quat.identity=o.identity},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(21);const r=n(1);n(21);const i=n(7);class a extends i.Asset{constructor(t,e=r.GL()){super(),this.propertyBlock={},this.name=`Material_${this.assetID}`,this.gl=e,this._shader=t}get shader(){return this._shader}set shader(t){const e=this.gl;if(t!=this._shader){this._shader=t;for(const t in this.propertyBlock){const n=e.getUniformLocation(this._shader.program,this.propertyBlock[t].name);this.propertyBlock[t].location=n}}}setup(t){var e;const n=t.gl;for(const r in this.propertyBlock){const i=this.propertyBlock[r];switch(i.type){case"float":n.uniform1f(i.location,this[r]);break;case"vec2":n.uniform2fv(i.location,this[r]);break;case"vec3":n.uniform3fv(i.location,this[r]);break;case"vec4":case"color":n.uniform4fv(i.location,this[r]);break;case"mat4":n.uniformMatrix4fv(i.location,!1,this[r]);break;case"tex2d":this[r]?null===(e=this[r]||null)||void 0===e||e.bind(i.location,t):t.assets.textures.default.bind(i.location,t)}}}setProp(t,e,n,r){let i=t,a=e,o=n,s=r;if("string"!=typeof n&&(i=a=t,o=e,s=n),this.propertyBlock[i])this.propertyBlock[i].type=o;else{const t=this.gl.getUniformLocation(this.shader.program,a);t&&(this.propertyBlock[i]={location:t,type:o,name:a})}this[i]=s}}e.Material=a;const o=Symbol("shaderProp");e.shaderProp=function(t,e){return Reflect.metadata(o,{name:t,type:e})},e.MaterialFromShader=function(t){return class extends a{constructor(e=r.GL()){super(t,e)}}},e.materialDefine=function(t){return class extends t{constructor(...t){var e;super(...t);const n=this.gl,r=this.shader,i=this.propertyBlock;for(const t in this){const u=(a=this,s=t,Reflect.getMetadata(o,a,s));if(!u)continue;const c=n.getUniformLocation(r.program,null===(e=u)||void 0===e?void 0:e.name);c&&(i[t]={type:u.type,location:c,name:u.name})}var a,s;this.propertyBlock=i}}}},function(t,e,n){(function(t,e){
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n;!function(n){!function(r){var i="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),a=o(n);function o(t,e){return function(n,r){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:r}),e&&e(n,r)}}void 0===i.Reflect?i.Reflect=n:a=o(i.Reflect,a),function(e){var n=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",a=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,s={__proto__:[]}instanceof Array,u=!o&&!s,c={create:o?function(){return L(Object.create(null))}:s?function(){return L({__proto__:null})}:function(){return L({})},has:u?function(t,e){return n.call(t,e)}:function(t,e){return e in t},get:u?function(t,e){return n.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},l=Object.getPrototypeOf(Function),h="object"==typeof t&&t.env&&"true"===t.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[a]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,r)},e.prototype.values=function(){return new n(this._keys,this._values,i)},e.prototype.entries=function(){return new n(this._keys,this._values,o)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[a]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function i(t,e){return e}function o(t,e){return[t,e]}}():Map,d=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new f}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[a]=function(){return this.keys()},t}():Set,m=new(h||"function"!=typeof WeakMap?function(){var t=c.create(),e=r();return function(){function t(){this._key=r()}return t.prototype.has=function(t){var e=i(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=i(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){return i(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=i(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=r()},t}();function r(){var e;do{e="@@WeakMap@@"+o()}while(c.has(t,e));return t[e]=!0,e}function i(t,r){if(!n.call(t,e)){if(!r)return;Object.defineProperty(t,e,{value:c.create()})}return t[e]}function a(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function o(){var t,e=(t=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t):a(new Array(t),t));e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var n="",r=0;r<16;++r){var i=e[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}():WeakMap);function v(t,e,n){var r=m.get(t);if(y(r)){if(!n)return;r=new f,m.set(t,r)}var i=r.get(e);if(y(i)){if(!n)return;i=new f,r.set(e,i)}return i}function p(t,e,n){var r=v(e,n,!1);return!y(r)&&!!r.has(t)}function g(t,e,n){var r=v(e,n,!1);if(!y(r))return r.get(t)}function _(t,e,n,r){v(n,r,!0).set(t,e)}function b(t,e){var n=[],r=v(t,e,!1);if(y(r))return n;for(var i=function(t){var e=P(t,a);if(!A(e))throw new TypeError;var n=e.call(t);if(!x(n))throw new TypeError;return n}(r.keys()),o=0;;){var s=S(i);if(!s)return n.length=o,n;var u=s.value;try{n[o]=u}catch(t){try{B(i)}finally{throw t}}o++}}function w(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function y(t){return void 0===t}function M(t){return null===t}function x(t){return"object"==typeof t?null!==t:"function"==typeof t}function T(t,e){switch(w(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",r=P(t,i);if(void 0!==r){var a=r.call(t,n);if(x(a))throw new TypeError;return a}return function(t,e){if("string"===e){var n=t.toString;if(A(n))if(!x(i=n.call(t)))return i;if(A(r=t.valueOf))if(!x(i=r.call(t)))return i}else{var r;if(A(r=t.valueOf))if(!x(i=r.call(t)))return i;var i,a=t.toString;if(A(a))if(!x(i=a.call(t)))return i}throw new TypeError}(t,"default"===n?"number":n)}function E(t){var e=T(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function R(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function A(t){return"function"==typeof t}function k(t){return"function"==typeof t}function P(t,e){var n=t[e];if(null!=n){if(!A(n))throw new TypeError;return n}}function S(t){var e=t.next();return!e.done&&e}function B(t){var e=t.return;e&&e.call(t)}function F(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===l)return e;if(e!==l)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var i=r.constructor;return"function"!=typeof i?e:i===t?e:i}function L(t){return t.__=void 0,delete t.__,t}e("decorate",(function(t,e,n,r){if(y(n)){if(!R(t))throw new TypeError;if(!k(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var r=(0,t[n])(e);if(!y(r)&&!M(r)){if(!k(r))throw new TypeError;e=r}}return e}(t,e)}if(!R(t))throw new TypeError;if(!x(e))throw new TypeError;if(!x(r)&&!y(r)&&!M(r))throw new TypeError;return M(r)&&(r=void 0),function(t,e,n,r){for(var i=t.length-1;i>=0;--i){var a=(0,t[i])(e,n,r);if(!y(a)&&!M(a)){if(!x(a))throw new TypeError;r=a}}return r}(t,e,n=E(n),r)})),e("metadata",(function(t,e){return function(n,r){if(!x(n))throw new TypeError;if(!y(r)&&!function(t){switch(w(t)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;_(t,e,n,r)}})),e("defineMetadata",(function(t,e,n,r){if(!x(n))throw new TypeError;return y(r)||(r=E(r)),_(t,e,n,r)})),e("hasMetadata",(function(t,e,n){if(!x(e))throw new TypeError;return y(n)||(n=E(n)),function t(e,n,r){if(p(e,n,r))return!0;var i=F(n);return!M(i)&&t(e,i,r)}(t,e,n)})),e("hasOwnMetadata",(function(t,e,n){if(!x(e))throw new TypeError;return y(n)||(n=E(n)),p(t,e,n)})),e("getMetadata",(function(t,e,n){if(!x(e))throw new TypeError;return y(n)||(n=E(n)),function t(e,n,r){if(p(e,n,r))return g(e,n,r);var i=F(n);return M(i)?void 0:t(e,i,r)}(t,e,n)})),e("getOwnMetadata",(function(t,e,n){if(!x(e))throw new TypeError;return y(n)||(n=E(n)),g(t,e,n)})),e("getMetadataKeys",(function(t,e){if(!x(t))throw new TypeError;return y(e)||(e=E(e)),function t(e,n){var r=b(e,n),i=F(e);if(null===i)return r;var a=t(i,n);if(a.length<=0)return r;if(r.length<=0)return a;for(var o=new d,s=[],u=0,c=r;u<c.length;u++){var l=c[u];o.has(l)||(o.add(l),s.push(l))}for(var h=0,f=a;h<f.length;h++){l=f[h];o.has(l)||(o.add(l),s.push(l))}return s}(t,e)})),e("getOwnMetadataKeys",(function(t,e){if(!x(t))throw new TypeError;return y(e)||(e=E(e)),b(t,e)})),e("deleteMetadata",(function(t,e,n){if(!x(e))throw new TypeError;y(n)||(n=E(n));var r=v(e,n,!1);if(y(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var i=m.get(e);return i.delete(n),i.size>0||(m.delete(e),!0)}))}(a)}()}(n||(n={}))}).call(this,n(46),n(47))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(3),i=n(1),a=n(28),o=n(3),s=n(7);var u,c,l;!function(t){t[t.Disable=-1]="Disable",t[t.Always=WebGL2RenderingContext.ALWAYS]="Always",t[t.Never=WebGL2RenderingContext.NEVER]="Never",t[t.Less=WebGL2RenderingContext.LESS]="Less",t[t.Equal=WebGL2RenderingContext.EQUAL]="Equal",t[t.LEqual=WebGL2RenderingContext.LEQUAL]="LEqual",t[t.Greater=WebGL2RenderingContext.GREATER]="Greater",t[t.NotEqual=WebGL2RenderingContext.NOTEQUAL]="NotEqual",t[t.GEqual=WebGL2RenderingContext.GEQUAL]="GEqual"}(u=e.DepthTest||(e.DepthTest={})),function(t){t[t.Disable=-1]="Disable",t[t.Zero=WebGL2RenderingContext.ZERO]="Zero",t[t.One=WebGL2RenderingContext.ONE]="One",t[t.SrcColor=WebGL2RenderingContext.SRC_COLOR]="SrcColor",t[t.OneMinusSrcColor=WebGL2RenderingContext.ONE_MINUS_SRC_COLOR]="OneMinusSrcColor",t[t.DstColor=WebGL2RenderingContext.DST_COLOR]="DstColor",t[t.OneMinusDstColor=WebGL2RenderingContext.ONE_MINUS_DST_COLOR]="OneMinusDstColor",t[t.SrcAlpha=WebGL2RenderingContext.SRC_ALPHA]="SrcAlpha",t[t.OneMinusSrcAlpha=WebGL2RenderingContext.ONE_MINUS_SRC_ALPHA]="OneMinusSrcAlpha",t[t.DstAlpha=WebGL2RenderingContext.DST_ALPHA]="DstAlpha",t[t.OneMinusDstAlpha=WebGL2RenderingContext.ONE_MINUS_DST_ALPHA]="OneMinusDstAlpha"}(c=e.Blending||(e.Blending={})),function(t){t[t.Disable=-1]="Disable",t[t.Back=WebGL2RenderingContext.BACK]="Back",t[t.Front=WebGL2RenderingContext.FRONT]="Front",t[t.Both=WebGL2RenderingContext.FRONT_AND_BACK]="Both"}(l=e.Culling||(e.Culling={})),e.DefaultShaderAttributes={vert:"aPos",color:"aColor",uv:"aUV",normal:"aNormal"};class h extends s.Asset{constructor(t,n,s={},h=i.GL()){super(s.name),this._compiled=!1,s.name||(this.name=`Shader_${this.assetID}`),this.gl=h,this.program=r.panicNull(h.createProgram(),"Failed to create shader program"),this.vertexShaderSource=t,this.fragmentShaderSouce=n,this.vertexShader=r.panicNull(h.createShader(h.VERTEX_SHADER),"Failed to create vertex shader"),this.fragmentShader=r.panicNull(h.createShader(h.FRAGMENT_SHADER),"Failed to create fragment shader"),this.compile();const f=s.attributes||e.DefaultShaderAttributes;this.attributes={vert:this.gl.getAttribLocation(this.program,f.vert),color:this.gl.getAttribLocation(this.program,f.color),uv:this.gl.getAttribLocation(this.program,f.uv),normal:this.gl.getAttribLocation(this.program,f.normal)},this.settings={depth:s.depth||u.Less,blend:s.blend||c.Disable,zWrite:!1!==s.zWrite,cull:s.cull||l.Back},this.builtinUniformLocations=o.getUniformsLocation(h,this.program,a.BuiltinUniforms)}get compiled(){return this._compiled}compile(){if(this.gl.shaderSource(this.vertexShader,this.vertexShaderSource),this.gl.compileShader(this.vertexShader),!this.gl.getShaderParameter(this.vertexShader,this.gl.COMPILE_STATUS))throw new Error("Failed to compile vertex shader:\r\n"+this.gl.getShaderInfoLog(this.vertexShader));if(this.gl.shaderSource(this.fragmentShader,this.fragmentShaderSouce),this.gl.compileShader(this.fragmentShader),!this.gl.getShaderParameter(this.fragmentShader,this.gl.COMPILE_STATUS))throw new Error("Failed to compile fragment shader:\r\n"+this.gl.getShaderInfoLog(this.fragmentShader));if(this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw new Error("Failed to link shader program:\r\n"+this.gl.getProgramInfoLog(this.program))}}e.Shader=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.AssetsPack=class{constructor(){this.mainAsset=null,this.assets=new Map}add(t,e){e.name=t,this.assets.set(t,e)}setMain(t){this.mainAsset=t}get(t){for(const[e,n]of this.assets)if(n instanceof t)return n;return null}getAll(t){return Array.from(this.assets.values()).filter(e=>e instanceof t)}}},function(t,e,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n(9).glMatrix.setMatrixArrayType(Array),r(n(2)),r(n(0)),r(n(5)),r(n(4)),r(n(10)),r(n(8)),r(n(19)),r(n(26))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ray=function(t,e){return{origin:t,direction:e.normalized}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n(20)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(22),i="#version 300 es\nprecision mediump float;\n\nin vec3 aPos;\nin vec4 aColor;\nin vec2 aUV;\nin vec3 aNormal;\n\nuniform mat4 uTransformM;\nuniform mat4 uTransformVP;\nuniform mat4 uTransformMVP;\n\nout vec4 vColor;\nout vec4 vPos;\nout vec2 vUV;\nout vec3 vNormal;\n\nvoid main()\n{\n    gl_Position = uTransformMVP * vec4(aPos, 1);\n    vColor = aColor;\n    vUV = aUV;\n    vNormal = aNormal;\n}\n";e.BuiltinShaderSources={DefaultVert:i,DefaultFrag:"#version 300 es\nprecision mediump float;\n\nin vec4 vColor;\nin vec4 vPos;\nin vec2 vUV;\n\nuniform sampler2D uMainTex;\nuniform vec4 uColor;\n\nout vec4 fragColor;\n\nvoid main()\n{\n    vec4 color = texture(uMainTex, vUV.xy).rgba;\n    color = color * vColor * uColor;\n    fragColor = color;\n}\n",BlitCopyFrag:"#version 300 es\nprecision mediump float;\n\nin vec4 vColor;\nin vec4 vPos;\nin vec2 vUV;\nin vec3 vNormal;\n\nuniform sampler2D uMainTex;\n\nout vec4 fragColor;\n\nvoid main()\n{\n    fragColor = texture(uMainTex, vUV).rgba;\n}\n",FlipTexVert:"#version 300 es\nprecision mediump float;\n\nin vec3 aPos;\nin vec2 aUV;\n\nout vec2 vUV;\n\nvoid main()\n{\n    gl_Position = vec4(aPos, 1);\n    vUV = vec2(aUV.x, vec2(1) - aUV.y);\n}"},e.BuiltinUniforms={matM:"uTransformM",matM_IT:"uTransformM_IT",matMInv:"uTransformMInv",matVP:"uTransformVP",matMVP:"uTransformMVP",matMV_IT:"uTransformMV_IT",flipUV:"uFlipUV",mainTex:"uMainTex"},e.compileBuiltinShaders=function(t){return{DefaultShader:new r.Shader(e.BuiltinShaderSources.DefaultVert,e.BuiltinShaderSources.DefaultFrag,{name:"DefaultShader"},t),BlitCopy:new r.Shader(e.BuiltinShaderSources.DefaultVert,e.BuiltinShaderSources.BlitCopyFrag,{name:"BlitCopy",depth:r.DepthTest.Always,blend:r.Blending.Disable,zWrite:!1},t),FlipTexture:new r.Shader(e.BuiltinShaderSources.FlipTexVert,e.BuiltinShaderSources.BlitCopyFrag,{},t),ColoredLine:new r.Shader("#version 300 es\nprecision mediump float;\n\nin vec3 aPos;\nin vec4 aColor;\n\nuniform mat4 uTransformM;\nuniform mat4 uTransformVP;\nuniform mat4 uTransformMVP;\n\nout vec4 vColor;\nout vec4 vPos;\n\nvoid main()\n{\n    gl_Position = uTransformMVP * vec4(aPos, 1);\n    vColor = aColor;\n}\n","#version 300 es\nprecision mediump float;\n\nin vec4 vColor;\nin vec4 vPos;\n\nout vec4 fragColor;\n\nvoid main()\n{\n    fragColor = vColor;\n}\n",{blend:[r.Blending.SrcAlpha,r.Blending.OneMinusSrcAlpha]},t),ErrorShader:new r.Shader(i,"#version 300 es\nprecision mediump float;\n\nin vec4 vPos;\nin vec2 vUV;\n\nuniform sampler2D uMainTex;\n\nout vec4 fragColor;\n\nvoid main()\n{\n    fragColor = texture(uMainTex, vUV).rgba;\n}\n",{name:"Error"},t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(25),i=n(1),a=n(15);e.MeshBuilder=class{constructor(t=0,e=i.GlobalContext().gl){this.verts=[],this.triangles=[],this.uvs=[],this.colors=[],this.gl=e}addPolygon(t,e){const n=this.verts.length;for(let n=0;n<t.length;n++)this.verts.push(t[n]),this.uvs.push(e[n]),this.colors.push(r.Color.white);for(let e=2;e<t.length;e++)this.triangles.push(n+0,n+e-1,n+e)}addSubMesh(t,e,n=[r.Color.white],i=[r.vec2(0,0)]){const a=this.verts.length;if(e.length%3!=0)throw new Error("Invalid number of triangles.");for(let e=0;e<t.length;e++)this.verts.push(t[e]),this.uvs.push(e>=i.length?i[i.length-1]:i[e]),this.colors.push(e>=n.length?n[n.length-1]:n[e]);for(let t=0;t<e.length;t++)this.triangles.push(a+e[t])}toMesh(){const t=new a.Mesh(this.gl);return t.verts=this.verts,t.triangles=this.triangles,t.colors=this.colors,t.uvs=this.uvs,t.calculateNormals(),t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(4),i=n(1),a=n(3),o=n(7);class s extends o.Asset{constructor(t=i.GL()){var e,n;super(),this._verts=[],this._colors=[],this._lines=[],this.dirty=!0,this.vertices=new Float32Array(0),this.indices=new Uint32Array(0),this.name=`Lines_${this.assetID}`,this.gl=t,this.VBO=null!=(e=t.createBuffer())?e:a.panic("Failed to create vertex buffer."),this.EBO=null!=(n=t.createBuffer())?n:a.panic("Failed to create element buffer.")}get verts(){return this._verts}set verts(t){this._verts=t,this.dirty=!0}get colors(){return this._colors}set colors(t){this._colors=t,this.dirty=!0}get lines(){return this._lines}set lines(t){this._lines=t,this.dirty=!0}clear(){this.verts=[],this.colors=[],this.lines=[]}update(){if(this.dirty){const t=this.gl;if(this.lines.length%2!=0)throw new Error("Invalid lines.");if(this.colors.length!==this.verts.length&&(this.colors=[...this.colors,...a.fillArray(r.Color.white,this.verts.length-this.colors.length)]),this.vertices=new Float32Array(this.verts.flatMap((t,e)=>[...t,...this.colors[e]])),this.vertices.length!=7*this.verts.length)throw new Error("Buffer with invalid length.");this.indices=new Uint32Array(this.lines.flat()),t.bindBuffer(t.ARRAY_BUFFER,this.VBO),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.EBO),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.DYNAMIC_DRAW),this.dirty=!1}}bind(t){const e=this.gl;this.update();const n=t.attributes;e.bindBuffer(e.ARRAY_BUFFER,this.VBO),n.vert>=0&&(e.vertexAttribPointer(n.vert,3,e.FLOAT,!1,28,0),e.enableVertexAttribArray(n.vert)),n.color>=0&&(e.vertexAttribPointer(n.color,4,e.FLOAT,!1,28,12),e.enableVertexAttribArray(n.color)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.EBO)}destroy(){this.destroyed||(this.gl.deleteBuffer(this.VBO),this.gl.deleteBuffer(this.EBO),super.destroy())}}e.Lines=s;e.LineBuilder=class{constructor(t=0,e=i.GL()){this.verts=[],this.colors=[],this.lines=[],this.gl=e}addLine(t,e=r.Color.white){const n=this.verts.length,[i,a]=t;this.verts.push(i,a),this.colors.push(e,e),this.lines.push(n,n+1)}toLines(){const t=new s(this.gl);return t.verts=this.verts,t.colors=this.colors,t.lines=this.lines,t.update(),t}}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(32)),r(n(34)),r(n(35)),r(n(12)),r(n(36)),r(n(33)),r(n(53)),r(n(54))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(13),i=n(17),a=n(1),o=n(2),s=n(12),u=n(8),c=n(10),l=n(4),h=n(0),f=n(26),d=n(5);var m;!function(t){t[t.Perspective=0]="Perspective",t[t.Orthographic=1]="Orthographic"}(m=e.Projection||(e.Projection={}));class v extends s.Entity{constructor(t=a.GlobalContext()){super(),this.output=i.RenderTarget.CanvasTarget,this.FOV=30,this.near=.3,this.far=1e3,this.viewHeight=1,this.projection=m.Perspective,this.clearColor=l.Color.black,this.clearDepth=!0,this.ctx=t}get pixelSize(){return this.output instanceof r.RenderTexture?o.vec2(this.output.width,this.output.height):o.vec2(this.ctx.width,this.ctx.height)}get aspectRatio(){return this.pixelSize.x/this.pixelSize.y}get viewProjectionMatrix(){const t=this.worldToLocalMatrix,e=this.projectionMatrix;return u.mat4.mul(e,t)}get projectionMatrix(){return this.projection===m.Perspective?u.mat4.perspective(this.FOV*c.Deg2Rad,this.aspectRatio,this.near,this.far):u.mat4.ortho(this.viewHeight,this.aspectRatio,this.near,this.far)}on(t,e){this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.on(t,e)}__preRender(t){this.eventEmitter.emit("prerender",this,t)}__postRender(t){this.eventEmitter.emit("postrender",this,t)}screenToRay(t){const e=this.screenToWorld(t);return f.ray(this.position,c.minus(h.vec3(e.x,e.y,e.z),this.position))}screenToWorld(t){const e=this.screenToViewport(t).mul(o.vec2(2,-2)).minus(o.vec2(1,-1)),n=c.mul(d.vec4(e.x,e.y,-1,1),this.near),r=u.mat4.invert(this.viewProjectionMatrix),i=u.mat4.mulVec4(r,n);return h.vec3(i[0],i[1],i[2])}screenToViewport(t){return this.output===i.RenderTarget.CanvasTarget?c.div(t,o.vec2(this.ctx.width,this.ctx.height)):this.output instanceof r.RenderTexture?c.div(t,o.vec2(this.output.width,this.output.height)):o.vec2.zero()}}e.Camera=v},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(8),i=n(0),a=n(19);e.Transform=class{constructor(){this._parent=null,this.children=new Set,this.localPosition=i.vec3.zero(),this.localRotation=a.quat.identity(),this.localScaling=i.vec3.one()}get position(){return this._parent?r.mat4.mulPoint(this._parent.localToWorldMatrix,this.localPosition):this.localPosition}set position(t){this._parent?this.localPosition=r.mat4.mulPoint(this._parent.worldToLocalMatrix,t):this.localPosition=t}get rotation(){return this._parent?a.quat.mul(this._parent.rotation,this.localRotation):this.localRotation}set rotation(t){this._parent?this.localRotation=a.quat.normalize(a.quat.mul(a.quat.invert(this._parent.rotation),t)):this.localRotation=a.quat.normalize(t)}get localToWorldMatrix(){if(!this._parent)return r.mat4.rts(this.localRotation,this.localPosition,this.localScaling);const t=r.mat4.rts(this.localRotation,this.localPosition,this.localScaling);return r.mat4.mul(t,this._parent.localToWorldMatrix,t)}get worldToLocalMatrix(){return r.mat4.invert(this.localToWorldMatrix)}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.children.add(this)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(12);class a extends i.Entity{constructor(t=r.GlobalContext()){super(),this.meshes=[],this.materials=[],this.materials=[t.assets.materials.default]}on(t,e){this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}}e.RenderObject=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(12),i=n(4);var a;!function(t){t[t.Directional=0]="Directional",t[t.Point=1]="Point"}(a=e.LightType||(e.LightType={}));class o extends r.Entity{constructor(t=a.Directional){super(),this.intensity=1,this.color=i.Color.white,this.type=t}}e.Light=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(12),i=n(11),a=n(14);class o extends r.EntityManager{constructor(){super(),this.eventEmitter=new i.EventEmitter,this.assetID=a.AssetManager.newAssetID(this),this.name=`Scene_${this.assetID}`}add(t,e){super.add(t);t.constructor;e&&(t.parent=e);for(const e of t.children)this.add(e,t);this.eventEmitter.emit("entity-add",t,e||null)}remove(t){super.remove(t),this.eventEmitter.emit("entity-remove",t,t.parent)}rootEntities(){return this._entities.filter(t=>null===t.parent)}getEntities(){return this._entities}getEntitiesOfType(t){return this.entities.filter(e=>e instanceof t)}on(t,e){this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}destroy(){throw this._entities=[],this.entityMap.clear(),new Error("Method not implemented.")}}e.Scene=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(8),i=n(38),a=n(4),o=n(17),s=n(30),u=n(0);e.PreviewRenderer=class{constructor(t){this.materialReplaceMap=new Map,this.renderer=t;const e=a.rgba(1,1,1,.1),n=new s.LineBuilder(0,t.gl);for(let t=-10;t<=10;t+=1)n.addLine([u.vec3(t,0,-10),u.vec3(t,0,10)],e),n.addLine([u.vec3(-10,0,t),u.vec3(10,0,t)],e);this.grid=n.toLines()}render(t,e){for(let n=0;n<e.length;n++){const r=new i.RenderData(e[n],t.scene);this.renderCamera(t,r)}}setupLight(t,e){t.renderer.setGlobalUniform("uLightDir","vec3",u.vec3(-1,1,0).normalize()),t.renderer.setGlobalUniform("uAmbientSky","color",a.rgb(.2,.2,.2)),t.renderer.setGlobalUniform("uLightPos","vec3",e.camera.position),t.renderer.setGlobalUniform("uLightColor","color",a.rgb(.8,.8,.8))}renderCamera(t,e){t.renderer.clear(a.rgb(.3,.3,.3),!0);const n=e.camera;n.__preRender(t),n.output===o.RenderTarget.CanvasTarget?t.renderer.setRenderTarget(o.RenderTarget.CanvasTarget):t.renderer.setRenderTarget(n.output),t.renderer.clear(n.clearColor,n.clearDepth),t.renderer.setViewProjection(n.worldToLocalMatrix,n.projectionMatrix),t.renderer.setGlobalUniform("uCameraPos","vec3",n.position),this.setupLight(t,e);const r=e.getVisibleObjects(i.RenderOrder.NearToFar);for(const e of r){const n=e.localToWorldMatrix;for(let r=0;r<e.meshes.length;r++){if(!e.meshes[r])continue;const i=e.materials[r]||t.renderer.assets.materials.default;this.drawWithMaterial(e.meshes[r],n,i)}}this.renderGrid(t,e),n.__postRender(t)}renderGrid(t,e){this.renderer.drawLines(this.grid,r.mat4.identity(),this.renderer.assets.materials.ColoredLine)}drawWithMaterial(t,e,n){this.materialReplaceMap.has(n.constructor)?this.renderer.drawMesh(t,e,this.materialReplaceMap.get(n.constructor)):this.renderer.drawMesh(t,e,n)}replaceMaterial(t,e){this.materialReplaceMap.set(t,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(34),i=n(35),a=n(8);var o;!function(t){t[t.NearToFar=0]="NearToFar",t[t.FarToNear=1]="FarToNear"}(o=e.RenderOrder||(e.RenderOrder={}));e.RenderData=class{constructor(t,e){this.visibleObjects=[],this.visibleLights=[],this.camera=t,this.visibleLights=e.getEntitiesOfType(i.Light),this.visibleObjects=e.getEntitiesOfType(r.RenderObject)}getVisibleObjects(t=o.NearToFar){const e=this.camera.worldToLocalMatrix;let n=this.visibleObjects.map(t=>({pos:a.mat4.mulPoint(e,t.position),obj:t}));return n=t===o.NearToFar?n.sort((t,e)=>t.pos.z-e.pos.z):n.sort((t,e)=>e.pos.z-t.pos.z),n.map(t=>t.obj)}getVisibleLights(){return this.visibleLights}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(56))},function(t,e,n){"use strict";t.exports=function(t,e,n,r){for(var i=65535&t|0,a=t>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{a=a+(i=i+e[r++]|0)|0}while(--o);i%=65521,a%=65521}return i|a<<16|0}},function(t,e,n){"use strict";var r=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();t.exports=function(t,e,n,i){var a=r,o=i+n;t^=-1;for(var s=i;s<o;s++)t=t>>>8^a[255&(t^e[s])];return-1^t}},function(t,e,n){"use strict";var r=n(6),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function u(t,e){if(e<65534&&(t.subarray&&a||!t.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",o=0;o<e;o++)n+=String.fromCharCode(t[o]);return n}o[254]=o[254]=1,e.string2buf=function(t){var e,n,i,a,o,s=t.length,u=0;for(a=0;a<s;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),u+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(u),o=0,a=0;o<u;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?e[o++]=n:n<2048?(e[o++]=192|n>>>6,e[o++]=128|63&n):n<65536?(e[o++]=224|n>>>12,e[o++]=128|n>>>6&63,e[o++]=128|63&n):(e[o++]=240|n>>>18,e[o++]=128|n>>>12&63,e[o++]=128|n>>>6&63,e[o++]=128|63&n);return e},e.buf2binstring=function(t){return u(t,t.length)},e.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},e.buf2string=function(t,e){var n,r,i,a,s=e||t.length,c=new Array(2*s);for(r=0,n=0;n<s;)if((i=t[n++])<128)c[r++]=i;else if((a=o[i])>4)c[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&n<s;)i=i<<6|63&t[n++],a--;a>1?c[r++]=65533:i<65536?c[r++]=i:(i-=65536,c[r++]=55296|i>>10&1023,c[r++]=56320|1023&i)}return u(c,r)},e.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0?e:0===n?e:n+o[t[n]]>e?n:e}},function(t,e,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}var i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0}),r(n(25)),r(n(14)),r(n(31)),r(n(55));const a=i(n(39));e.plugins=a,r(n(39)),r(n(72))},function(t,e){var n,r,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!l){var t=s(f);l=!0;for(var e=c.length;e;){for(u=c,c=[];++h<e;)u&&u[h].run();h=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new m(t,e)),1!==c.length||l||s(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(3),i=n(1),a=n(0),o=n(4),s=n(8),u=n(17),c=n(13),l=n(2),h=n(49),f=n(19),d=n(22);e.ZograRenderer=class{constructor(t,e,n){this.viewProjectionMatrix=s.mat4.identity(),this.viewMatrix=s.mat4.identity(),this.projectionMatrix=s.mat4.identity(),this.target=u.RenderTarget.CanvasTarget,this.shader=null,this.globalUniforms=new Map,this.globalTextures=new Map,this.canvas=t,this.width=void 0===e?t.width:e,this.height=void 0===n?t.height:n,this.canvas.width=this.width,this.canvas.height=this.height,this.gl=r.panicNull(this.canvas.getContext("webgl2"),"WebGL2 is not support on current device."),this.assets=new h.BuiltinAssets(this.gl),this.ctx={gl:this.gl,width:this.width,height:this.height,assets:this.assets},i.GlobalContext()||this.use()}use(){i.setGlobalContext(this.ctx)}setSize(t,e){this.canvas.width=t,this.canvas.height=e,this.width=t,this.height=e,this.ctx.width=t,this.ctx.height=e}setViewProjection(t,e){this.viewProjectionMatrix=s.mat4.mul(e,t)}setRenderTarget(t,e){if(t instanceof u.RenderTarget)this.target!==t&&this.target.release(),this.target=t;else if(t instanceof Array){this.target.release(),this.target=new u.RenderTarget(t[0].width,t[0].height,this.ctx);for(let e=0;e<t.length;e++)this.target.addColorAttachment(t[e])}else t instanceof c.RenderTexture&&(this.target.release(),this.target=new u.RenderTarget(t.width,t.height,this.ctx),this.target.addColorAttachment(t));e&&this.target.setDepthAttachment(e),this.target.bind(this.ctx)}clear(t=o.Color.black,e=!0){this.gl.clearColor(t.r,t.g,t.b,t.a),this.gl.clear(this.gl.COLOR_BUFFER_BIT|(e?this.gl.DEPTH_BUFFER_BIT:0))}blit(t,e,n=this.assets.materials.blitCopy){if(e instanceof c.RenderTexture){const t=new u.RenderTarget(e.width,e.height,this.ctx);t.addColorAttachment(e),e=t}else if(e instanceof Array){const t=new u.RenderTarget(0,0,this.ctx);for(let n=0;n<e.length;n++)t.addColorAttachment(e[n]);e=t}const r=this.viewProjectionMatrix,i=this.target;this.target=e,this.viewProjectionMatrix=s.mat4.identity(),this.setGlobalTexture("uMainTex",t),this.drawMesh(this.assets.meshes.quad,s.mat4.rts(f.quat.identity(),a.vec3(0,0,0),a.vec3(2,2,1)),n),this.unsetGlobalTexture("uMainTex"),this.target=i,this.viewProjectionMatrix=r}useShader(t){const e=this.gl;if(this.shader=t,e.useProgram(t.program),t.settings.depth===d.DepthTest.Disable?e.disable(e.DEPTH_TEST):(e.enable(e.DEPTH_TEST),e.depthMask(t.settings.zWrite),e.depthFunc(t.settings.depth)),t.settings.blend===d.Blending.Disable)e.disable(e.BLEND);else{const[n,r]="number"==typeof t.settings.blend?[t.settings.blend,d.Blending.Zero]:t.settings.blend;e.enable(e.BLEND),e.blendFunc(n,r)}t.settings.cull===d.Culling.Disable?e.disable(e.CULL_FACE):(e.enable(e.CULL_FACE),e.cullFace(t.settings.cull),e.frontFace(e.CCW))}setupTransforms(t,e){const n=this.gl,r=s.mat4.mul(this.viewProjectionMatrix,e),i=s.mat4.transpose(s.mat4.invert(e)),a=s.mat4.transpose(s.mat4.invert(s.mat4.mul(this.viewMatrix,e)));t.builtinUniformLocations.matM&&n.uniformMatrix4fv(t.builtinUniformLocations.matM,!1,e),t.builtinUniformLocations.matVP&&n.uniformMatrix4fv(t.builtinUniformLocations.matVP,!1,this.viewProjectionMatrix),t.builtinUniformLocations.matMVP&&n.uniformMatrix4fv(t.builtinUniformLocations.matMVP,!1,r),t.builtinUniformLocations.matM_IT&&n.uniformMatrix4fv(t.builtinUniformLocations.matM_IT,!1,i),t.builtinUniformLocations.matMV_IT&&n.uniformMatrix4fv(t.builtinUniformLocations.matMV_IT,!1,a)}setupGlobalUniforms(t,e){const n=this.gl;for(const e of this.globalUniforms.values()){const r=n.getUniformLocation(t.program,e.name);if(r)switch(e.type){case"int":n.uniform1i(r,e.value);break;case"float":n.uniform1f(r,e.value);break;case"vec2":n.uniform2fv(r,e.value,0,2);break;case"vec3":n.uniform3fv(r,e.value,0,3);break;case"vec4":case"color":n.uniform4fv(r,e.value,0,4)}}for(const r of this.globalTextures.values()){const i=n.getUniformLocation(t.program,r.name);i&&r.texture.bind(i,e)}}drawMesh(t,e,n){n||(n=this.assets.materials.error);const r=this.gl,i={assets:this.assets,gl:r,nextTextureUnit:0,size:l.vec2(this.width,this.height)};this.target.bind(this.ctx),this.useShader(n.shader),n.setup(i),this.setupTransforms(n.shader,e),this.setupGlobalUniforms(n.shader,i),t.bind(n.shader,r),r.drawElements(r.TRIANGLES,t.triangles.length,r.UNSIGNED_INT,0)}drawLines(t,e,n){const r=this.gl,i={assets:this.assets,gl:r,nextTextureUnit:0,size:l.vec2(this.width,this.height)};this.target.bind(this.ctx),this.useShader(n.shader),n.setup(i),this.setupTransforms(n.shader,e),this.setupGlobalUniforms(n.shader,i),t.bind(n.shader),r.drawElements(r.LINES,t.lines.length,r.UNSIGNED_INT,0)}setGlobalUniform(t,e,n){this.globalUniforms.set(t,{name:t,type:e,value:n})}unsetGlobalUniform(t){this.globalUniforms.delete(t)}setGlobalTexture(t,e){this.globalTextures.set(t,{name:t,texture:e})}unsetGlobalTexture(t){this.globalTextures.delete(t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(50),i=n(28),a=n(51),o=n(52);e.BuiltinAssets=class{constructor(t){let e={assets:this,gl:t,width:0,height:0};this.gl=t,this.BuiltinUniforms=i.BuiltinUniforms,this.shaderSources=i.BuiltinShaderSources,this.shaders=i.compileBuiltinShaders(t),this.meshes=o.createBuiltinMesh(t),this.textures=a.createDefaultTextures(e),this.types=r.createBuiltinMaterialTypes(t,this.textures,this.shaders),this.materials=r.createBuiltinMaterial(t,this.types,this.shaders,this.textures)}}},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var i,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(o=(a<3?i(o):a>3?i(e,n,o):i(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o};Object.defineProperty(e,"__esModule",{value:!0});const i=n(20),a=n(4),o=(n(27),n(2));e.createBuiltinMaterial=function(t,e,n,r){const a=new i.Material(n.ErrorShader,t);return a.setProp("uMainTex","tex2d",r.error),{error:a,default:new e.DefaultMaterial(t),blitCopy:new e.BlitCopy(t),ColoredLine:new i.Material(n.ColoredLine,t)}},e.createBuiltinMaterialTypes=function(t,e,n){let s=class extends(i.MaterialFromShader(n.DefaultShader)){constructor(){super(...arguments),this.color=a.Color.white,this.mainTexture=e.default}};r([i.shaderProp("uColor","color")],s.prototype,"color",void 0),r([i.shaderProp("uMainTex","tex2d")],s.prototype,"mainTexture",void 0),s=r([i.materialDefine],s);let u=class extends(i.MaterialFromShader(n.BlitCopy)){constructor(){super(...arguments),this.flip=o.vec2(0,0)}};r([i.shaderProp("uFlip","vec2")],u.prototype,"flip",void 0),u=r([i.materialDefine],u);let c=class extends(i.MaterialFromShader(n.DefaultShader)){constructor(){super(...arguments),this.color=a.Color.white,this.mainTexture=e.default,this.normalTexture=e.defaultNormal,this.emission=a.Color.black,this.specular=a.Color.white,this.metiallic=.023,this.smoothness=.5,this.fresnel=5}};return r([i.shaderProp("uColor","color")],c.prototype,"color",void 0),r([i.shaderProp("uMainTex","tex2d")],c.prototype,"mainTexture",void 0),r([i.shaderProp("uNormalTex","tex2d")],c.prototype,"normalTexture",void 0),r([i.shaderProp("uEmission","color")],c.prototype,"emission",void 0),r([i.shaderProp("uSpecular","color")],c.prototype,"specular",void 0),r([i.shaderProp("uMetallic","float")],c.prototype,"metiallic",void 0),r([i.shaderProp("uSmoothness","float")],c.prototype,"smoothness",void 0),r([i.shaderProp("uFresnel","float")],c.prototype,"fresnel",void 0),c=r([i.materialDefine],c),{DefaultMaterial:s,BlitCopy:u,DefaultLit:c}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(3),i=n(13),a=n(18);e.createDefaultTextures=function(t){var e;const n=document.createElement("canvas");n.width=n.height=64;const o=null!=(e=n.getContext("2d"))?e:r.panic("Failed to create default texture.");o.fillStyle="black",o.fillRect(0,0,64,64),o.fillStyle="cyan",o.fillRect(0,0,32,32),o.fillRect(32,32,32,32);const s=new i.Texture2D(64,64,a.TextureFormat.RGBA,i.FilterMode.Linear,t);s.setData(n),s.name="Texture-Error",o.fillStyle="blue",o.fillRect(0,0,64,64);const u=new i.Texture2D(64,64,a.TextureFormat.RGBA,i.FilterMode.Linear,t);u.setData(n),u.name="Default-Normal",o.fillStyle="white",o.fillRect(0,0,64,64);const c=new i.Texture2D(64,64,a.TextureFormat.RGBA,i.FilterMode.Linear,t);return c.setData(n),c.name="Default-White",{default:c,defaultNormal:u,error:s}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(15),i=n(0),a=n(2),o=n(29);function s(t){const e=new r.Mesh(t);return e.verts=[i.vec3(-.5,-.5,0),i.vec3(.5,-.5,0),i.vec3(.5,.5,0),i.vec3(-.5,.5,0)],e.triangles=[0,1,3,1,2,3],e.uvs=[a.vec2(0,0),a.vec2(1,0),a.vec2(1,1),a.vec2(0,1)],e.calculateNormals(),e.name="mesh_quad",e}function u(t){const e=new r.Mesh(t);return e.verts=[i.vec3(-1,-1,0),i.vec3(1,-1,0),i.vec3(1,1,0),i.vec3(-1,1,0)],e.triangles=[0,1,3,1,2,3],e.uvs=[a.vec2(0,0),a.vec2(1,0),a.vec2(1,1),a.vec2(0,1)],e.calculateNormals(),e.name="mesh_screen_quad",e}function c(t){const e=[i.vec3(-.5,-.5,-.5),i.vec3(.5,-.5,-.5),i.vec3(.5,.5,-.5),i.vec3(-.5,.5,-.5),i.vec3(-.5,-.5,.5),i.vec3(.5,-.5,.5),i.vec3(.5,.5,.5),i.vec3(-.5,.5,.5)],n=[a.vec2(0,0),a.vec2(1,0),a.vec2(1,1),a.vec2(0,1)],r=new o.MeshBuilder(24,t);r.addPolygon([e[1],e[0],e[3],e[2]],[n[0],n[1],n[2],n[3]]),r.addPolygon([e[5],e[1],e[2],e[6]],[n[0],n[1],n[2],n[3]]),r.addPolygon([e[4],e[5],e[6],e[7]],[n[0],n[1],n[2],n[3]]),r.addPolygon([e[0],e[4],e[7],e[3]],[n[0],n[1],n[2],n[3]]),r.addPolygon([e[7],e[6],e[2],e[3]],[n[0],n[1],n[2],n[3]]),r.addPolygon([e[0],e[1],e[5],e[4]],[n[0],n[1],n[2],n[3]]);const s=r.toMesh();return s.name="mesh_cube",s}e.createBuiltinMesh=function(t){return{quad:s(t),screenQuad:u(t),cube:c(t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(36),i=n(37),a=n(32),o=n(14),s=n(11);e.ZograEngine=class{constructor(t,e=i.PreviewRenderer){this._time={deltaTime:0,time:0},this.renderer=new o.ZograRenderer(t,t.width,t.height),this.renderPipeline=new e(this.renderer),this._scene=new r.Scene,this.eventEmitter=new s.EventEmitter}get time(){return this._time}get scene(){return this._scene}set scene(t){const e=this._scene;this._scene=t,this.eventEmitter.emit("scene-change",t,e)}renderScene(){const t=this.scene.getEntitiesOfType(a.Camera);this.renderPipeline.render({renderer:this.renderer,scene:this.scene},t)}updateEntities(t){const e=this.scene.rootEntities();for(const n of e)n.__updateRecursive(t)}start(){let t=0,e=0;const n=r=>{if(0===t)return e=t=r,void requestAnimationFrame(n);const i=(r-t)/1e3;t=r;const o={time:(r-e)/1e3,deltaTime:i};this._time=o,this.eventEmitter.emit("update",o),this.updateEntities(o),this.eventEmitter.emit("render",this.scene.getEntitiesOfType(a.Camera)),this.renderScene(),requestAnimationFrame(n)};requestAnimationFrame(n)}on(t,e){this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2),i=n(10),a=n(3);var o,s;!function(t){t[t.Pressed=1]="Pressed",t[t.Released=0]="Released"}(o=e.KeyState||(e.KeyState={}));class u{constructor(){this.keyStates=new Map,this.keyStatesThisFrame=new Map,this.mousePos=r.vec2.zero(),this.mouseDelta=r.vec2.zero(),this.wheelDelta=0}}e.InputManager=class{constructor(t={}){var e,n;this.preventBrowserShortcut=!0,this.states=new a.DoubleBuffer(()=>new u),this.eventTarget=t.target||window,t.bound?this.bound=t.bound:(null===(e=t.target)||void 0===e?void 0:e.getBoundingClientRect)&&(this.bound=t.target),this.pointerLockElement=null!=(n=t.pointerLockElement)?n:document.body,this.eventTarget.addEventListener("keydown",t=>{this.states.back.keyStates.set(t.keyCode,o.Pressed),this.states.back.keyStatesThisFrame.set(t.keyCode,o.Pressed),this.preventBrowserShortcut&&t.ctrlKey&&(t.keyCode==s.S||t.keyCode==s.W)&&(t.preventDefault(),t.stopPropagation())}),this.eventTarget.addEventListener("keyup",t=>{this.states.back.keyStates.set(t.keyCode,o.Released),this.states.back.keyStatesThisFrame.set(t.keyCode,o.Released)}),this.eventTarget.addEventListener("mousedown",t=>{var e,n;const a=null===(e=this.bound)||void 0===e?void 0:e.getBoundingClientRect();if(a){const e=r.vec2(a.left,null===(n=a)||void 0===n?void 0:n.top),o=i.minus(r.vec2(t.clientX,t.clientY),e);if(o.x<0||o.y<0||o.x>a.width||o.y>a.height)return}this.states.back.keyStates.set(s.Mouse0+t.button,o.Pressed),this.states.back.keyStatesThisFrame.set(s.Mouse0+t.button,o.Pressed)}),this.eventTarget.addEventListener("mouseup",t=>{var e,n;const a=null===(e=this.bound)||void 0===e?void 0:e.getBoundingClientRect();if(a){const e=r.vec2(a.left,null===(n=a)||void 0===n?void 0:n.top),o=i.minus(r.vec2(t.clientX,t.clientY),e);if(o.x<0||o.y<0||o.x>a.width||o.y>a.height)return}this.states.back.keyStates.set(s.Mouse0+t.button,o.Released),this.states.back.keyStatesThisFrame.set(s.Mouse0+t.button,o.Released)}),this.eventTarget.addEventListener("mousemove",t=>{var e,n,a,o,s;const u=null===(e=this.bound)||void 0===e?void 0:e.getBoundingClientRect(),c=r.vec2(null!=(a=null===(n=u)||void 0===n?void 0:n.left)?a:0,null!=(s=null===(o=u)||void 0===o?void 0:o.top)?s:0),l=i.minus(r.vec2(t.clientX,t.clientY),c);this.states.back.mouseDelta.plus(r.vec2(t.movementX,t.movementY)),this.states.back.mousePos=l}),this.eventTarget.addEventListener("wheel",t=>{this.states.back.wheelDelta=t.deltaY});for(const t in s)isNaN(t)&&s.hasOwnProperty(t)&&this.states.back.keyStates.set(s[t],o.Released);window.addEventListener("beforeunload",t=>{!this.preventBrowserShortcut||this.states.back.keyStates.get(s.W)!==o.Pressed&&this.states.back.keyStates.get(s.Control)!==o.Pressed||(t.preventDefault(),t.returnValue="Really want to quit?")})}get pointerPosition(){return this.states.current.mousePos}get pointerDelta(){return this.states.current.mouseDelta}get wheelDelta(){return this.states.current.wheelDelta}getKey(t){return this.states.current.keyStates.get(t)===o.Pressed}getKeyDown(t){return this.states.current.keyStatesThisFrame.get(t)===o.Pressed}getKeyUp(t){return this.states.current.keyStatesThisFrame.get(t)===o.Released}update(){this.states.update(),this.states.back.keyStatesThisFrame.clear(),this.states.back.mouseDelta=r.vec2.zero(),this.states.back.wheelDelta=0;for(const[t,e]of this.states.current.keyStates)this.states.back.keyStates.set(t,e);this.states.back.mousePos=this.states.current.mousePos}lockPointer(){this.pointerLockElement.requestPointerLock()}releasePointer(){document.exitPointerLock()}},function(t){t[t.BackSpace=8]="BackSpace",t[t.Tab=9]="Tab",t[t.Clear=12]="Clear",t[t.Enter=13]="Enter",t[t.Shift=16]="Shift",t[t.Control=17]="Control",t[t.Alt=18]="Alt",t[t.Pause=19]="Pause",t[t.CapsLock=20]="CapsLock",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.Prior=33]="Prior",t[t.Next=34]="Next",t[t.End=35]="End",t[t.Home=36]="Home",t[t.Left=37]="Left",t[t.Up=38]="Up",t[t.Right=39]="Right",t[t.Down=40]="Down",t[t.Select=41]="Select",t[t.Print=42]="Print",t[t.Execute=43]="Execute",t[t.Insert=45]="Insert",t[t.Delete=46]="Delete",t[t.Help=47]="Help",t[t.Num0=48]="Num0",t[t.Num1=49]="Num1",t[t.Num2=50]="Num2",t[t.Num3=51]="Num3",t[t.Num4=52]="Num4",t[t.Num5=53]="Num5",t[t.Num6=54]="Num6",t[t.Num7=55]="Num7",t[t.Num8=56]="Num8",t[t.Num9=57]="Num9",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.KP0=96]="KP0",t[t.KP1=97]="KP1",t[t.KP2=98]="KP2",t[t.KP3=99]="KP3",t[t.KP4=100]="KP4",t[t.KP5=101]="KP5",t[t.KP6=102]="KP6",t[t.KP7=103]="KP7",t[t.KP8=104]="KP8",t[t.KP9=105]="KP9",t[t.KPMultiply=106]="KPMultiply",t[t.KPAdd=107]="KPAdd",t[t.KPSeparator=108]="KPSeparator",t[t.KPSubtract=109]="KPSubtract",t[t.KPDecimal=110]="KPDecimal",t[t.KPDivide=111]="KPDivide",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.F13=124]="F13",t[t.F14=125]="F14",t[t.F15=126]="F15",t[t.F16=127]="F16",t[t.F17=128]="F17",t[t.F18=129]="F18",t[t.F19=130]="F19",t[t.F20=131]="F20",t[t.F21=132]="F21",t[t.F22=133]="F22",t[t.F23=134]="F23",t[t.F24=135]="F24",t[t.NumLock=136]="NumLock",t[t.ScrollLock=137]="ScrollLock",t[t.Mouse0=256]="Mouse0",t[t.Mouse1=257]="Mouse1",t[t.Mouse2=258]="Mouse2",t[t.Mouse3=259]="Mouse3",t[t.Mouse4=260]="Mouse4",t[t.Mouse5=261]="Mouse5",t[t.Mouse6=262]="Mouse6"}(s=e.Keys||(e.Keys={}))},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(37)),r(n(38))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(57),a=n(71),o=n(16);!function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(23));const s={img:a.TextureImporter,fbx:i.FBXImporter};function u(t,e=r.GlobalContext()){const n={};for(const r in s)n[r]=n=>s[r].import(t,n,e);return n}e.AssetsImporter={importers:s,url:async(t,e=r.GlobalContext())=>u(await fetch(t).then(t=>t.arrayBuffer()),e),blob:async(t,e=r.GlobalContext())=>u(await o.readBlob(t),e),buffer:async(t,e=r.GlobalContext())=>u(t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(23),i=n(1),a=n(4),o=n(5),s=n(31),u=n(0),c=n(15),l=n(2),h=n(58),f=n(69);function d(t,e=i.GlobalContext()){const n=new r.AssetsPack,a=new Map,h=function(t){return e=>{const n=new c.Mesh(t.gl);return n.verts=e.verts.map(t=>u.vec3.from(t)),n.normals=e.normals.map(t=>u.vec3.from(t)),n.uvs=e.uv0.map(t=>l.vec2.from(t)),n.triangles=e.triangles,n.update(),n}}(e);for(const r of t.materials){const t=new e.assets.types.DefaultLit(e.gl);t.name=r.name,t.color=m(r,"DiffuseColor",t.color),t.emission=m(r,"Emissive",t.emission),t.specular=m(r,"Specular",t.specular),t.emission.mul(o.vec4(v(r,"EmissiveFactor",1))),a.set(r.id,t),n.add(t.name,t)}for(const r of t.models){const t=new s.RenderObject(e);t.name=r.name,t.localPosition=u.vec3.from(r.transform.localPosition),t.localRotation=r.transform.localRotation,t.localScaling=u.vec3.from(r.transform.localScaling),t.meshes=r.meshes.map(h),t.meshes.forEach((e,r)=>n.add(`${t.name}_${r}`,e)),t.materials=r.meshes.map(t=>{var n;return null!=(n=a.get(t.material.id))?n:e.assets.materials.default}),a.set(r.id,t)}const f=new s.Entity;f.name="FBX Model",n.add("FBX Model",f),n.setMain(f);for(const e of t.models)if(e.transform.parent){var d=a.get(e.id),p=a.get(e.transform.parent.model.id);d.parent=p}else a.get(e.id).parent=f;for(const t of a.values())n.add(t.name,t);return n}function m(t,e,n=a.Color.white){if(void 0===t[e]||t[e].length<3)return n;if(3===t[e].length){const[n,r,i]=t[e];return new a.Color(n,r,i)}const[r,i,o,s]=t[e];return new a.Color(r,i,o,s)}function v(t,e,n=0){return void 0===t[e]?n:isNaN(t[e])?n:t[e]}e.FBXImporter={async import(t,e,n=i.GlobalContext()){const r=h.parseFBX(t);return d(f.extractFBXAssets(r),n)}}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=n(59),a=r(n(60));function o(t,e){const n=[];for(;;){const e=s(t);if(null===e)break;n.push(e)}if(e>0&&t.position!==e)throw new Error("Unexpectly end of nodes.");return n}function s(t){const e=t.readUInt32(),n=t.readUInt32(),r=t.readUInt32(),i=t.readUInt8();if(0===e&&0===n&&0===r&&0===i)return null;const a={name:t.readString(i),properties:new Array(n),nestedNodes:[]},s={Y:()=>t.readInt16(),C:()=>t.readBoolean(),I:()=>t.readInt32(),F:()=>t.readFloat32(),D:()=>t.readFloat64(),L:()=>t.readUInt64(),f:()=>new Float32Array(u(t,4)),d:()=>new Float64Array(u(t,8)),l:()=>new BigInt64Array(u(t,8)),i:()=>new Int32Array(u(t,4)),b:()=>Array.from(new Uint8Array(u(t,1))).map(t=>1===t),S:()=>t.readString(t.readUInt32()),R:()=>t.readBytes(t.readUInt32())},c=t.position;for(let e=0;e<n;e++){const n=s[t.readChar()]();a.properties[e]=n}if(t.position!==c+r)throw new Error("Unexpectly end of property list.");return t.position<e&&(a.nestedNodes=o(t,e)),a}function u(t,e){const n=t.readUInt32(),r=t.readUInt32(),i=t.readUInt32();if(0===r)return t.readSlice(e*n);{const e=t.readSlice(i);return a.default.inflate(new Uint8Array(e)).buffer}}e.parseFBX=function(t){const e={version:0,nodes:[]},n=new i.DataReader(t);if("Kaydara FBX Binary  "===n.readString(20)){n.position=23;const t=n.readUInt32();e.version=t,n.position=27,e.nodes=o(n,0)}return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(16);e.DataReader=class{constructor(t,e=0){this.buffer=t,this.dataView=new DataView(t),this.position=e}readSlice(t){const e=this.buffer.slice(this.position,this.position+t);return this.position+=t,e}readUInt8(){const t=this.dataView.getUint8(this.position);return this.position+=1,t}readInt8(){const t=this.dataView.getInt8(this.position);return this.position+=1,t}readUInt16(){const t=this.dataView.getUint16(this.position,!0);return this.position+=2,t}readInt16(){const t=this.dataView.getInt16(this.position,!0);return this.position+=2,t}readUInt32(){const t=this.dataView.getUint32(this.position,!0);return this.position+=4,t}readInt32(){const t=this.dataView.getInt32(this.position,!0);return this.position+=4,t}readUInt64(){const t=this.dataView.getBigUint64(this.position,!0);return this.position+=8,t}readInt64(){const t=this.dataView.getBigInt64(this.position,!0);return this.position+=8,t}readBoolean(){return 1===this.readUInt8()}readFloat32(){const t=this.dataView.getFloat32(this.position,!0);return this.position+=4,t}readFloat64(){const t=this.dataView.getFloat64(this.position,!0);return this.position+=8,t}readChar(){const t=this.readUInt8();return String.fromCharCode(t)}readString(t){const e=r.readString(this.buffer,this.position,t);return this.position+=t,e}readBytes(t){const e=new Uint8Array(this.buffer,this.position,t);return this.position+=t,e}}},function(t,e,n){"use strict";var r={};(0,n(6).assign)(r,n(61),n(64),n(44)),t.exports=r},function(t,e,n){"use strict";var r=n(62),i=n(6),a=n(42),o=n(24),s=n(43),u=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==n)throw new Error(o[n]);if(e.header&&r.deflateSetHeader(this.strm,e.header),e.dictionary){var l;if(l="string"==typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(n=r.deflateSetDictionary(this.strm,l)))throw new Error(o[n]);this._dict_set=!0}}function l(t,e){var n=new c(e);if(n.push(t,!0),n.err)throw n.msg||o[n.err];return n.result}c.prototype.push=function(t,e){var n,o,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?4:0,"string"==typeof t?s.input=a.string2buf(t):"[object ArrayBuffer]"===u.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=r.deflate(s,o))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==o||(this.onEnd(0),s.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=c,e.deflate=l,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,l(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,l(t,e)}},function(t,e,n){"use strict";var r,i=n(6),a=n(63),o=n(40),s=n(41),u=n(24);function c(t,e){return t.msg=u[e],e}function l(t){return(t<<1)-(t>4?9:0)}function h(t){for(var e=t.length;--e>=0;)t[e]=0}function f(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(i.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function d(t,e){a._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,f(t.strm)}function m(t,e){t.pending_buf[t.pending++]=e}function v(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function p(t,e){var n,r,i=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match,u=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,c=t.window,l=t.w_mask,h=t.prev,f=t.strstart+258,d=c[a+o-1],m=c[a+o];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(c[(n=e)+o]===m&&c[n+o-1]===d&&c[n]===c[a]&&c[++n]===c[a+1]){a+=2,n++;do{}while(c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<f);if(r=258-(f-a),a=f-258,r>o){if(t.match_start=e,o=r,r>=s)break;d=c[a+o-1],m=c[a+o]}}}while((e=h[e&l])>u&&0!=--i);return o<=t.lookahead?o:t.lookahead}function g(t){var e,n,r,a,u,c,l,h,f,d,m=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=m+(m-262)){i.arraySet(t.window,t.window,m,m,0),t.match_start-=m,t.strstart-=m,t.block_start-=m,e=n=t.hash_size;do{r=t.head[--e],t.head[e]=r>=m?r-m:0}while(--n);e=n=m;do{r=t.prev[--e],t.prev[e]=r>=m?r-m:0}while(--n);a+=m}if(0===t.strm.avail_in)break;if(c=t.strm,l=t.window,h=t.strstart+t.lookahead,f=a,d=void 0,(d=c.avail_in)>f&&(d=f),n=0===d?0:(c.avail_in-=d,i.arraySet(l,c.input,c.next_in,d,h),1===c.state.wrap?c.adler=o(c.adler,l,d,h):2===c.state.wrap&&(c.adler=s(c.adler,l,d,h)),c.next_in+=d,c.total_in+=d,d),t.lookahead+=n,t.lookahead+t.insert>=3)for(u=t.strstart-t.insert,t.ins_h=t.window[u],t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+3-1])&t.hash_mask,t.prev[u&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=u,u++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function _(t,e){for(var n,r;;){if(t.lookahead<262){if(g(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-262&&(t.match_length=p(t,n)),t.match_length>=3)if(r=a._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(d(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(d(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(d(t,!1),0===t.strm.avail_out)?1:2}function b(t,e){for(var n,r,i;;){if(t.lookahead<262){if(g(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-262&&(t.match_length=p(t,n),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,r=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(d(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((r=a._tr_tally(t,0,t.window[t.strstart-1]))&&d(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(d(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(d(t,!1),0===t.strm.avail_out)?1:2}function w(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),h(this.dyn_ltree),h(this.dyn_dtree),h(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),h(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),h(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function M(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=0,a._tr_init(e),0):c(t,-2)}function x(t){var e,n=M(t);return 0===n&&((e=t.state).window_size=2*e.w_size,h(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),n}function T(t,e,n,r,a,o){if(!t)return-2;var s=1;if(-1===e&&(e=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),a<1||a>9||8!==n||r<8||r>15||e<0||e>9||o<0||o>4)return c(t,-2);8===r&&(r=9);var u=new y;return t.state=u,u.strm=t,u.wrap=s,u.gzhead=null,u.w_bits=r,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=a+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new i.Buf8(2*u.w_size),u.head=new i.Buf16(u.hash_size),u.prev=new i.Buf16(u.w_size),u.lit_bufsize=1<<a+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new i.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=e,u.strategy=o,u.method=n,x(t)}r=[new w(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(g(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,d(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(d(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(d(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(d(t,!1),t.strm.avail_out),1)})),new w(4,4,8,4,_),new w(4,5,16,8,_),new w(4,6,32,32,_),new w(4,4,16,16,b),new w(8,16,32,32,b),new w(8,16,128,128,b),new w(8,32,128,256,b),new w(32,128,258,1024,b),new w(32,258,258,4096,b)],e.deflateInit=function(t,e){return T(t,e,8,15,8,0)},e.deflateInit2=T,e.deflateReset=x,e.deflateResetKeep=M,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?-2:(t.state.gzhead=e,0):-2},e.deflate=function(t,e){var n,i,o,u;if(!t||!t.state||e>5||e<0)return t?c(t,-2):-2;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||666===i.status&&4!==e)return c(t,0===t.avail_out?-5:-2);if(i.strm=t,n=i.last_flush,i.last_flush=e,42===i.status)if(2===i.wrap)t.adler=0,m(i,31),m(i,139),m(i,8),i.gzhead?(m(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),m(i,255&i.gzhead.time),m(i,i.gzhead.time>>8&255),m(i,i.gzhead.time>>16&255),m(i,i.gzhead.time>>24&255),m(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),m(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(m(i,255&i.gzhead.extra.length),m(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=s(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(m(i,0),m(i,0),m(i,0),m(i,0),m(i,0),m(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),m(i,3),i.status=113);else{var p=8+(i.w_bits-8<<4)<<8;p|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(p|=32),p+=31-p%31,i.status=113,v(i,p),0!==i.strstart&&(v(i,t.adler>>>16),v(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),f(t),o=i.pending,i.pending!==i.pending_buf_size));)m(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),f(t),o=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,m(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),0===u&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),f(t),o=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,m(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>o&&(t.adler=s(t.adler,i.pending_buf,i.pending-o,o)),0===u&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&f(t),i.pending+2<=i.pending_buf_size&&(m(i,255&t.adler),m(i,t.adler>>8&255),t.adler=0,i.status=113)):i.status=113),0!==i.pending){if(f(t),0===t.avail_out)return i.last_flush=-1,0}else if(0===t.avail_in&&l(e)<=l(n)&&4!==e)return c(t,-5);if(666===i.status&&0!==t.avail_in)return c(t,-5);if(0!==t.avail_in||0!==i.lookahead||0!==e&&666!==i.status){var _=2===i.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(g(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(d(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(d(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(d(t,!1),0===t.strm.avail_out)?1:2}(i,e):3===i.strategy?function(t,e){for(var n,r,i,o,s=t.window;;){if(t.lookahead<=258){if(g(t),t.lookahead<=258&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=s[i=t.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){o=t.strstart+258;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);t.match_length=258-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=a._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(d(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(d(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(d(t,!1),0===t.strm.avail_out)?1:2}(i,e):r[i.level].func(i,e);if(3!==_&&4!==_||(i.status=666),1===_||3===_)return 0===t.avail_out&&(i.last_flush=-1),0;if(2===_&&(1===e?a._tr_align(i):5!==e&&(a._tr_stored_block(i,0,0,!1),3===e&&(h(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),f(t),0===t.avail_out))return i.last_flush=-1,0}return 4!==e?0:i.wrap<=0?1:(2===i.wrap?(m(i,255&t.adler),m(i,t.adler>>8&255),m(i,t.adler>>16&255),m(i,t.adler>>24&255),m(i,255&t.total_in),m(i,t.total_in>>8&255),m(i,t.total_in>>16&255),m(i,t.total_in>>24&255)):(v(i,t.adler>>>16),v(i,65535&t.adler)),f(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},e.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?c(t,-2):(t.state=null,113===e?c(t,-3):0):-2},e.deflateSetDictionary=function(t,e){var n,r,a,s,u,c,l,f,d=e.length;if(!t||!t.state)return-2;if(2===(s=(n=t.state).wrap)||1===s&&42!==n.status||n.lookahead)return-2;for(1===s&&(t.adler=o(t.adler,e,d,0)),n.wrap=0,d>=n.w_size&&(0===s&&(h(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new i.Buf8(n.w_size),i.arraySet(f,e,d-n.w_size,n.w_size,0),e=f,d=n.w_size),u=t.avail_in,c=t.next_in,l=t.input,t.avail_in=d,t.next_in=0,t.input=e,g(n);n.lookahead>=3;){r=n.strstart,a=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--a);n.strstart=r,n.lookahead=2,g(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=c,t.input=l,t.avail_in=u,n.wrap=s,0},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,n){"use strict";var r=n(6);function i(t){for(var e=t.length;--e>=0;)t[e]=0}var a=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],o=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],u=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=new Array(576);i(c);var l=new Array(60);i(l);var h=new Array(512);i(h);var f=new Array(256);i(f);var d=new Array(29);i(d);var m,v,p,g=new Array(30);function _(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function b(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function w(t){return t<256?h[t]:h[256+(t>>>7)]}function y(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function M(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,y(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function x(t,e,n){M(t,n[2*e],n[2*e+1])}function T(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function E(t,e,n){var r,i,a=new Array(16),o=0;for(r=1;r<=15;r++)a[r]=o=o+n[r-1]<<1;for(i=0;i<=e;i++){var s=t[2*i+1];0!==s&&(t[2*i]=T(a[s]++,s))}}function R(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function A(t){t.bi_valid>8?y(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function k(t,e,n,r){var i=2*e,a=2*n;return t[i]<t[a]||t[i]===t[a]&&r[e]<=r[n]}function P(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&k(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!k(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function S(t,e,n){var r,i,s,u,c=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*c]<<8|t.pending_buf[t.d_buf+2*c+1],i=t.pending_buf[t.l_buf+c],c++,0===r?x(t,i,e):(x(t,(s=f[i])+256+1,e),0!==(u=a[s])&&M(t,i-=d[s],u),x(t,s=w(--r),n),0!==(u=o[s])&&M(t,r-=g[s],u))}while(c<t.last_lit);x(t,256,e)}function B(t,e){var n,r,i,a=e.dyn_tree,o=e.stat_desc.static_tree,s=e.stat_desc.has_stree,u=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<u;n++)0!==a[2*n]?(t.heap[++t.heap_len]=c=n,t.depth[n]=0):a[2*n+1]=0;for(;t.heap_len<2;)a[2*(i=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[i]=0,t.opt_len--,s&&(t.static_len-=o[2*i+1]);for(e.max_code=c,n=t.heap_len>>1;n>=1;n--)P(t,a,n);i=u;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],P(t,a,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,a[2*i]=a[2*n]+a[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,a[2*n+1]=a[2*r+1]=i,t.heap[1]=i++,P(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,r,i,a,o,s,u=e.dyn_tree,c=e.max_code,l=e.stat_desc.static_tree,h=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,d=e.stat_desc.extra_base,m=e.stat_desc.max_length,v=0;for(a=0;a<=15;a++)t.bl_count[a]=0;for(u[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)(a=u[2*u[2*(r=t.heap[n])+1]+1]+1)>m&&(a=m,v++),u[2*r+1]=a,r>c||(t.bl_count[a]++,o=0,r>=d&&(o=f[r-d]),s=u[2*r],t.opt_len+=s*(a+o),h&&(t.static_len+=s*(l[2*r+1]+o)));if(0!==v){do{for(a=m-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[m]--,v-=2}while(v>0);for(a=m;0!==a;a--)for(r=t.bl_count[a];0!==r;)(i=t.heap[--n])>c||(u[2*i+1]!==a&&(t.opt_len+=(a-u[2*i+1])*u[2*i],u[2*i+1]=a),r--)}}(t,e),E(a,c,t.bl_count)}function F(t,e,n){var r,i,a=-1,o=e[1],s=0,u=7,c=4;for(0===o&&(u=138,c=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=e[2*(r+1)+1],++s<u&&i===o||(s<c?t.bl_tree[2*i]+=s:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,a=i,0===o?(u=138,c=3):i===o?(u=6,c=3):(u=7,c=4))}function L(t,e,n){var r,i,a=-1,o=e[1],s=0,u=7,c=4;for(0===o&&(u=138,c=3),r=0;r<=n;r++)if(i=o,o=e[2*(r+1)+1],!(++s<u&&i===o)){if(s<c)do{x(t,i,t.bl_tree)}while(0!=--s);else 0!==i?(i!==a&&(x(t,i,t.bl_tree),s--),x(t,16,t.bl_tree),M(t,s-3,2)):s<=10?(x(t,17,t.bl_tree),M(t,s-3,3)):(x(t,18,t.bl_tree),M(t,s-11,7));s=0,a=i,0===o?(u=138,c=3):i===o?(u=6,c=3):(u=7,c=4)}}i(g);var C=!1;function D(t,e,n,i){M(t,0+(i?1:0),3),function(t,e,n,i){A(t),i&&(y(t,n),y(t,~n)),r.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}e._tr_init=function(t){C||(!function(){var t,e,n,r,i,u=new Array(16);for(n=0,r=0;r<28;r++)for(d[r]=n,t=0;t<1<<a[r];t++)f[n++]=r;for(f[n-1]=r,i=0,r=0;r<16;r++)for(g[r]=i,t=0;t<1<<o[r];t++)h[i++]=r;for(i>>=7;r<30;r++)for(g[r]=i<<7,t=0;t<1<<o[r]-7;t++)h[256+i++]=r;for(e=0;e<=15;e++)u[e]=0;for(t=0;t<=143;)c[2*t+1]=8,t++,u[8]++;for(;t<=255;)c[2*t+1]=9,t++,u[9]++;for(;t<=279;)c[2*t+1]=7,t++,u[7]++;for(;t<=287;)c[2*t+1]=8,t++,u[8]++;for(E(c,287,u),t=0;t<30;t++)l[2*t+1]=5,l[2*t]=T(t,5);m=new _(c,a,257,286,15),v=new _(l,o,0,30,15),p=new _(new Array(0),s,0,19,7)}(),C=!0),t.l_desc=new b(t.dyn_ltree,m),t.d_desc=new b(t.dyn_dtree,v),t.bl_desc=new b(t.bl_tree,p),t.bi_buf=0,t.bi_valid=0,R(t)},e._tr_stored_block=D,e._tr_flush_block=function(t,e,n,r){var i,a,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),B(t,t.l_desc),B(t,t.d_desc),o=function(t){var e;for(F(t,t.dyn_ltree,t.l_desc.max_code),F(t,t.dyn_dtree,t.d_desc.max_code),B(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*u[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),i=t.opt_len+3+7>>>3,(a=t.static_len+3+7>>>3)<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==e?D(t,e,n,r):4===t.strategy||a===i?(M(t,2+(r?1:0),3),S(t,c,l)):(M(t,4+(r?1:0),3),function(t,e,n,r){var i;for(M(t,e-257,5),M(t,n-1,5),M(t,r-4,4),i=0;i<r;i++)M(t,t.bl_tree[2*u[i]+1],3);L(t,t.dyn_ltree,e-1),L(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),S(t,t.dyn_ltree,t.dyn_dtree)),R(t),r&&A(t)},e._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(f[n]+256+1)]++,t.dyn_dtree[2*w(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){M(t,2,3),x(t,256,c),function(t){16===t.bi_valid?(y(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,n){"use strict";var r=n(65),i=n(6),a=n(42),o=n(44),s=n(24),u=n(43),c=n(68),l=Object.prototype.toString;function h(t){if(!(this instanceof h))return new h(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,e.windowBits);if(n!==o.Z_OK)throw new Error(s[n]);if(this.header=new c,r.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=a.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=r.inflateSetDictionary(this.strm,e.dictionary))!==o.Z_OK))throw new Error(s[n])}function f(t,e){var n=new h(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}h.prototype.push=function(t,e){var n,s,u,c,h,f=this.strm,d=this.options.chunkSize,m=this.options.dictionary,v=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof t?f.input=a.binstring2buf(t):"[object ArrayBuffer]"===l.call(t)?f.input=new Uint8Array(t):f.input=t,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(d),f.next_out=0,f.avail_out=d),(n=r.inflate(f,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(n=r.inflateSetDictionary(this.strm,m)),n===o.Z_BUF_ERROR&&!0===v&&(n=o.Z_OK,v=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&n!==o.Z_STREAM_END&&(0!==f.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(u=a.utf8border(f.output,f.next_out),c=f.next_out-u,h=a.buf2string(f.output,u),f.next_out=c,f.avail_out=d-c,c&&i.arraySet(f.output,f.output,u,c,0),this.onData(h)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(v=!0)}while((f.avail_in>0||0===f.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),f.avail_out=0,!0)},h.prototype.onData=function(t){this.chunks.push(t)},h.prototype.onEnd=function(t){t===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=h,e.inflate=f,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},e.ungzip=f},function(t,e,n){"use strict";var r=n(6),i=n(40),a=n(41),o=n(66),s=n(67);function u(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function l(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(852),e.distcode=e.distdyn=new r.Buf32(592),e.sane=1,e.back=-1,0):-2}function h(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,l(t)):-2}function f(t,e){var n,r;return t&&t.state?(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?-2:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,h(t))):-2}function d(t,e){var n,r;return t?(r=new c,t.state=r,r.window=null,0!==(n=f(t,e))&&(t.state=null),n):-2}var m,v,p=!0;function g(t){if(p){var e;for(m=new r.Buf32(512),v=new r.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(1,t.lens,0,288,m,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(2,t.lens,0,32,v,0,t.work,{bits:5}),p=!1}t.lencode=m,t.lenbits=9,t.distcode=v,t.distbits=5}function _(t,e,n,i){var a,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,e,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>i&&(a=i),r.arraySet(o.window,e,n-i,a,o.wnext),(i-=a)?(r.arraySet(o.window,e,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}e.inflateReset=h,e.inflateReset2=f,e.inflateResetKeep=l,e.inflateInit=function(t){return d(t,15)},e.inflateInit2=d,e.inflate=function(t,e){var n,c,l,h,f,d,m,v,p,b,w,y,M,x,T,E,R,A,k,P,S,B,F,L,C=0,D=new r.Buf8(4),I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return-2;12===(n=t.state).mode&&(n.mode=13),f=t.next_out,l=t.output,m=t.avail_out,h=t.next_in,c=t.input,d=t.avail_in,v=n.hold,p=n.bits,b=d,w=m,B=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;p<16;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if(2&n.wrap&&35615===v){n.check=0,D[0]=255&v,D[1]=v>>>8&255,n.check=a(n.check,D,2,0),v=0,p=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&v)<<8)+(v>>8))%31){t.msg="incorrect header check",n.mode=30;break}if(8!=(15&v)){t.msg="unknown compression method",n.mode=30;break}if(p-=4,S=8+(15&(v>>>=4)),0===n.wbits)n.wbits=S;else if(S>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<S,t.adler=n.check=1,n.mode=512&v?10:12,v=0,p=0;break;case 2:for(;p<16;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if(n.flags=v,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=v>>8&1),512&n.flags&&(D[0]=255&v,D[1]=v>>>8&255,n.check=a(n.check,D,2,0)),v=0,p=0,n.mode=3;case 3:for(;p<32;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}n.head&&(n.head.time=v),512&n.flags&&(D[0]=255&v,D[1]=v>>>8&255,D[2]=v>>>16&255,D[3]=v>>>24&255,n.check=a(n.check,D,4,0)),v=0,p=0,n.mode=4;case 4:for(;p<16;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}n.head&&(n.head.xflags=255&v,n.head.os=v>>8),512&n.flags&&(D[0]=255&v,D[1]=v>>>8&255,n.check=a(n.check,D,2,0)),v=0,p=0,n.mode=5;case 5:if(1024&n.flags){for(;p<16;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}n.length=v,n.head&&(n.head.extra_len=v),512&n.flags&&(D[0]=255&v,D[1]=v>>>8&255,n.check=a(n.check,D,2,0)),v=0,p=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((y=n.length)>d&&(y=d),y&&(n.head&&(S=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,c,h,y,S)),512&n.flags&&(n.check=a(n.check,c,y,h)),d-=y,h+=y,n.length-=y),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===d)break t;y=0;do{S=c[h+y++],n.head&&S&&n.length<65536&&(n.head.name+=String.fromCharCode(S))}while(S&&y<d);if(512&n.flags&&(n.check=a(n.check,c,y,h)),d-=y,h+=y,S)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===d)break t;y=0;do{S=c[h+y++],n.head&&S&&n.length<65536&&(n.head.comment+=String.fromCharCode(S))}while(S&&y<d);if(512&n.flags&&(n.check=a(n.check,c,y,h)),d-=y,h+=y,S)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;p<16;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if(v!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}v=0,p=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;p<32;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}t.adler=n.check=u(v),v=0,p=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=f,t.avail_out=m,t.next_in=h,t.avail_in=d,n.hold=v,n.bits=p,2;t.adler=n.check=1,n.mode=12;case 12:if(5===e||6===e)break t;case 13:if(n.last){v>>>=7&p,p-=7&p,n.mode=27;break}for(;p<3;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}switch(n.last=1&v,p-=1,3&(v>>>=1)){case 0:n.mode=14;break;case 1:if(g(n),n.mode=20,6===e){v>>>=2,p-=2;break t}break;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}v>>>=2,p-=2;break;case 14:for(v>>>=7&p,p-=7&p;p<32;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if((65535&v)!=(v>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&v,v=0,p=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(y=n.length){if(y>d&&(y=d),y>m&&(y=m),0===y)break t;r.arraySet(l,c,h,y,f),d-=y,h+=y,m-=y,f+=y,n.length-=y;break}n.mode=12;break;case 17:for(;p<14;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if(n.nlen=257+(31&v),v>>>=5,p-=5,n.ndist=1+(31&v),v>>>=5,p-=5,n.ncode=4+(15&v),v>>>=4,p-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;p<3;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}n.lens[I[n.have++]]=7&v,v>>>=3,p-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,F={bits:n.lenbits},B=s(0,n.lens,0,19,n.lencode,0,n.work,F),n.lenbits=F.bits,B){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;E=(C=n.lencode[v&(1<<n.lenbits)-1])>>>16&255,R=65535&C,!((T=C>>>24)<=p);){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if(R<16)v>>>=T,p-=T,n.lens[n.have++]=R;else{if(16===R){for(L=T+2;p<L;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if(v>>>=T,p-=T,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}S=n.lens[n.have-1],y=3+(3&v),v>>>=2,p-=2}else if(17===R){for(L=T+3;p<L;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}p-=T,S=0,y=3+(7&(v>>>=T)),v>>>=3,p-=3}else{for(L=T+7;p<L;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}p-=T,S=0,y=11+(127&(v>>>=T)),v>>>=7,p-=7}if(n.have+y>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;y--;)n.lens[n.have++]=S}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,F={bits:n.lenbits},B=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,F),n.lenbits=F.bits,B){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,F={bits:n.distbits},B=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,F),n.distbits=F.bits,B){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(d>=6&&m>=258){t.next_out=f,t.avail_out=m,t.next_in=h,t.avail_in=d,n.hold=v,n.bits=p,o(t,w),f=t.next_out,l=t.output,m=t.avail_out,h=t.next_in,c=t.input,d=t.avail_in,v=n.hold,p=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;E=(C=n.lencode[v&(1<<n.lenbits)-1])>>>16&255,R=65535&C,!((T=C>>>24)<=p);){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if(E&&0==(240&E)){for(A=T,k=E,P=R;E=(C=n.lencode[P+((v&(1<<A+k)-1)>>A)])>>>16&255,R=65535&C,!(A+(T=C>>>24)<=p);){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}v>>>=A,p-=A,n.back+=A}if(v>>>=T,p-=T,n.back+=T,n.length=R,0===E){n.mode=26;break}if(32&E){n.back=-1,n.mode=12;break}if(64&E){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&E,n.mode=22;case 22:if(n.extra){for(L=n.extra;p<L;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}n.length+=v&(1<<n.extra)-1,v>>>=n.extra,p-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;E=(C=n.distcode[v&(1<<n.distbits)-1])>>>16&255,R=65535&C,!((T=C>>>24)<=p);){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if(0==(240&E)){for(A=T,k=E,P=R;E=(C=n.distcode[P+((v&(1<<A+k)-1)>>A)])>>>16&255,R=65535&C,!(A+(T=C>>>24)<=p);){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}v>>>=A,p-=A,n.back+=A}if(v>>>=T,p-=T,n.back+=T,64&E){t.msg="invalid distance code",n.mode=30;break}n.offset=R,n.extra=15&E,n.mode=24;case 24:if(n.extra){for(L=n.extra;p<L;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}n.offset+=v&(1<<n.extra)-1,v>>>=n.extra,p-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===m)break t;if(y=w-m,n.offset>y){if((y=n.offset-y)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}y>n.wnext?(y-=n.wnext,M=n.wsize-y):M=n.wnext-y,y>n.length&&(y=n.length),x=n.window}else x=l,M=f-n.offset,y=n.length;y>m&&(y=m),m-=y,n.length-=y;do{l[f++]=x[M++]}while(--y);0===n.length&&(n.mode=21);break;case 26:if(0===m)break t;l[f++]=n.length,m--,n.mode=21;break;case 27:if(n.wrap){for(;p<32;){if(0===d)break t;d--,v|=c[h++]<<p,p+=8}if(w-=m,t.total_out+=w,n.total+=w,w&&(t.adler=n.check=n.flags?a(n.check,l,w,f-w):i(n.check,l,w,f-w)),w=m,(n.flags?v:u(v))!==n.check){t.msg="incorrect data check",n.mode=30;break}v=0,p=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;p<32;){if(0===d)break t;d--,v+=c[h++]<<p,p+=8}if(v!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}v=0,p=0}n.mode=29;case 29:B=1;break t;case 30:B=-3;break t;case 31:return-4;case 32:default:return-2}return t.next_out=f,t.avail_out=m,t.next_in=h,t.avail_in=d,n.hold=v,n.bits=p,(n.wsize||w!==t.avail_out&&n.mode<30&&(n.mode<27||4!==e))&&_(t,t.output,t.next_out,w-t.avail_out)?(n.mode=31,-4):(b-=t.avail_in,w-=t.avail_out,t.total_in+=b,t.total_out+=w,n.total+=w,n.wrap&&w&&(t.adler=n.check=n.flags?a(n.check,l,w,t.next_out-w):i(n.check,l,w,t.next_out-w)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===b&&0===w||4===e)&&0===B&&(B=-5),B)},e.inflateEnd=function(t){if(!t||!t.state)return-2;var e=t.state;return e.window&&(e.window=null),t.state=null,0},e.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?-2:(n.head=e,e.done=!1,0):-2},e.inflateSetDictionary=function(t,e){var n,r=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?-2:11===n.mode&&i(1,e,r,0)!==n.check?-3:_(t,e,r,r)?(n.mode=31,-4):(n.havedict=1,0):-2},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,n){"use strict";t.exports=function(t,e){var n,r,i,a,o,s,u,c,l,h,f,d,m,v,p,g,_,b,w,y,M,x,T,E,R;n=t.state,r=t.next_in,E=t.input,i=r+(t.avail_in-5),a=t.next_out,R=t.output,o=a-(e-t.avail_out),s=a+(t.avail_out-257),u=n.dmax,c=n.wsize,l=n.whave,h=n.wnext,f=n.window,d=n.hold,m=n.bits,v=n.lencode,p=n.distcode,g=(1<<n.lenbits)-1,_=(1<<n.distbits)-1;t:do{m<15&&(d+=E[r++]<<m,m+=8,d+=E[r++]<<m,m+=8),b=v[d&g];e:for(;;){if(d>>>=w=b>>>24,m-=w,0===(w=b>>>16&255))R[a++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=v[(65535&b)+(d&(1<<w)-1)];continue e}if(32&w){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}y=65535&b,(w&=15)&&(m<w&&(d+=E[r++]<<m,m+=8),y+=d&(1<<w)-1,d>>>=w,m-=w),m<15&&(d+=E[r++]<<m,m+=8,d+=E[r++]<<m,m+=8),b=p[d&_];n:for(;;){if(d>>>=w=b>>>24,m-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=p[(65535&b)+(d&(1<<w)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(M=65535&b,m<(w&=15)&&(d+=E[r++]<<m,(m+=8)<w&&(d+=E[r++]<<m,m+=8)),(M+=d&(1<<w)-1)>u){t.msg="invalid distance too far back",n.mode=30;break t}if(d>>>=w,m-=w,M>(w=a-o)){if((w=M-w)>l&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(x=0,T=f,0===h){if(x+=c-w,w<y){y-=w;do{R[a++]=f[x++]}while(--w);x=a-M,T=R}}else if(h<w){if(x+=c+h-w,(w-=h)<y){y-=w;do{R[a++]=f[x++]}while(--w);if(x=0,h<y){y-=w=h;do{R[a++]=f[x++]}while(--w);x=a-M,T=R}}}else if(x+=h-w,w<y){y-=w;do{R[a++]=f[x++]}while(--w);x=a-M,T=R}for(;y>2;)R[a++]=T[x++],R[a++]=T[x++],R[a++]=T[x++],y-=3;y&&(R[a++]=T[x++],y>1&&(R[a++]=T[x++]))}else{x=a-M;do{R[a++]=R[x++],R[a++]=R[x++],R[a++]=R[x++],y-=3}while(y>2);y&&(R[a++]=R[x++],y>1&&(R[a++]=R[x++]))}break}}break}}while(r<i&&a<s);r-=y=m>>3,d&=(1<<(m-=y<<3))-1,t.next_in=r,t.next_out=a,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=a<s?s-a+257:257-(a-s),n.hold=d,n.bits=m}},function(t,e,n){"use strict";var r=n(6),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,n,u,c,l,h,f){var d,m,v,p,g,_,b,w,y,M=f.bits,x=0,T=0,E=0,R=0,A=0,k=0,P=0,S=0,B=0,F=0,L=null,C=0,D=new r.Buf16(16),I=new r.Buf16(16),N=null,U=0;for(x=0;x<=15;x++)D[x]=0;for(T=0;T<u;T++)D[e[n+T]]++;for(A=M,R=15;R>=1&&0===D[R];R--);if(A>R&&(A=R),0===R)return c[l++]=20971520,c[l++]=20971520,f.bits=1,0;for(E=1;E<R&&0===D[E];E++);for(A<E&&(A=E),S=1,x=1;x<=15;x++)if(S<<=1,(S-=D[x])<0)return-1;if(S>0&&(0===t||1!==R))return-1;for(I[1]=0,x=1;x<15;x++)I[x+1]=I[x]+D[x];for(T=0;T<u;T++)0!==e[n+T]&&(h[I[e[n+T]]++]=T);if(0===t?(L=N=h,_=19):1===t?(L=i,C-=257,N=a,U-=257,_=256):(L=o,N=s,_=-1),F=0,T=0,x=E,g=l,k=A,P=0,v=-1,p=(B=1<<A)-1,1===t&&B>852||2===t&&B>592)return 1;for(;;){b=x-P,h[T]<_?(w=0,y=h[T]):h[T]>_?(w=N[U+h[T]],y=L[C+h[T]]):(w=96,y=0),d=1<<x-P,E=m=1<<k;do{c[g+(F>>P)+(m-=d)]=b<<24|w<<16|y|0}while(0!==m);for(d=1<<x-1;F&d;)d>>=1;if(0!==d?(F&=d-1,F+=d):F=0,T++,0==--D[x]){if(x===R)break;x=e[n+h[T]]}if(x>A&&(F&p)!==v){for(0===P&&(P=A),g+=E,S=1<<(k=x-P);k+P<R&&!((S-=D[k+P])<=0);)k++,S<<=1;if(B+=1<<k,1===t&&B>852||2===t&&B>592)return 1;c[v=F&p]=A<<24|k<<16|g-l|0}}return 0!==F&&(c[g+F]=x-P<<24|64<<16|0),f.bits=A,0}},function(t,e,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(70),i=n(9),a=n(3),o=n(16);function s(t){var e,n,a,o,s,u,c,l,h,f,d,m,v,p,g,_,b,w,y,M,x,T,E,R,A;const k={id:t.properties[0],name:t.properties[1].split("\0")[0],meshes:[],materials:[],transform:null};k.transform=new r.FBXTransform(k);const P=t.nestedNodes.find(t=>"Properties70"===t.name),S=null===(e=P)||void 0===e?void 0:e.nestedNodes.find(t=>"Lcl Translation"===t.properties[0]),B=null===(n=P)||void 0===n?void 0:n.nestedNodes.find(t=>"Lcl Rotation"===t.properties[0]),F=null===(a=P)||void 0===a?void 0:a.nestedNodes.find(t=>"Lcl Scaling"===t.properties[0]),L=null===(o=P)||void 0===o?void 0:o.nestedNodes.find(t=>"PreRotation"===t.properties[0]);return k.transform.localPosition=i.vec3.fromValues(null!=(u=null===(s=S)||void 0===s?void 0:s.properties[4])?u:0,null!=(l=null===(c=S)||void 0===c?void 0:c.properties[5])?l:0,null!=(f=null===(h=S)||void 0===h?void 0:h.properties[6])?f:0),k.transform.localRotation=i.quat.fromEuler(i.quat.create(),null!=(m=null===(d=B)||void 0===d?void 0:d.properties[4])?m:0,null!=(p=null===(v=B)||void 0===v?void 0:v.properties[5])?p:0,null!=(_=null===(g=B)||void 0===g?void 0:g.properties[6])?_:0),k.transform.localScaling=i.vec3.fromValues(null!=(w=null===(b=F)||void 0===b?void 0:b.properties[4])?w:1,null!=(M=null===(y=F)||void 0===y?void 0:y.properties[5])?M:1,null!=(T=null===(x=F)||void 0===x?void 0:x.properties[6])?T:1),L&&(k.transform.localRotation=i.quat.mul(k.transform.localRotation,i.quat.fromEuler(i.quat.create(),null!=(E=L.properties[4])?E:0,null!=(R=L.properties[5])?R:0,null!=(A=L.properties[6])?A:0),k.transform.localRotation)),k}function u(t){var e,n,r,i,s;const u=t.properties[0],d=t.properties[1].split("\0")[0],v=null!=(n=null===(e=t.nestedNodes.find(t=>"Vertices"===t.name))||void 0===e?void 0:e.properties[0])?n:new Float64Array,p=null!=(i=null===(r=t.nestedNodes.find(t=>"PolygonVertexIndex"===t.name))||void 0===r?void 0:r.properties[0])?i:new Int32Array,g=t.nestedNodes.find(t=>"LayerElementNormal"===t.name),_=t.nestedNodes.find(t=>"LayerElementUV"===t.name&&0===t.properties[0]),b=t.nestedNodes.find(t=>"LayerElementUV"===t.name&&1===t.properties[0]),w=t.nestedNodes.find(t=>"LayerElementMaterial"===t.name);let y=[],M=[],x=[],T=[],E=[];if(v.length%3!=0)throw new Error("Invalid vertices size.");const R=l(v);M=Array.from(p).map(t=>R[t>=0?t:-1^t]);let A=0;for(let t=0;t<p.length;)if(t+3<p.length&&p[t+3]<0)y[A++]=[t,t+1,t+2,t+3],t+=4;else{if(!(t+2<p.length&&p[t+2]<0))throw new Error("Invalid length of polygon index list.");y[A++]=[t,t+1,t+2],t+=3}if(g&&(x=c(g,"Normals",y,M,l)),_&&(T=c(_,"UV",y,M,h)),b&&(E=c(b,"UV",y,M,h)),w){const t=new Map,e=m(w,"MappingInformationType"),n=m(w,"ReferenceInformationType"),r=null!=(s=m(w,"Materials"))?s:a.panic("Missing materials.");if("AllSame"===e)return[{id:u,name:d,colors:[],verts:M,normals:x,triangles:f(y),uv0:T,uv1:E,material:null,mateiralId:0}];if("ByPolygon"!==e||"IndexToDirect"!==n)throw new Error(`Unsupported material info type '${e}', '${n}'.`);o.assert(r.length===y.length,"length of Material list missmatch.");for(let e=0;e<r.length;e++)t.has(r[e])||t.set(r[e],[]),t.get(r[e]).push(e);const i=[];for(const[e,n]of t){const t={id:u,name:d,colors:[],verts:[],normals:[],triangles:[],uv0:[],uv1:[],material:null,mateiralId:e};let r=0;const a=[];for(const e of n){a.push(y[e]);for(let n=0;n<y[e].length;n++){const i=y[e][n];t.verts[r]=M[i],x.length>0&&(t.normals[r]=x[i]),T.length>0&&(t.uv0[r]=T[i]),E.length>0&&(t.uv1[r]=E[i]),r++}}t.triangles=f(a),i.push(t)}return i}return[{id:u,name:d,colors:[],verts:M,normals:x,triangles:f(y),uv0:T,uv1:E,material:null,mateiralId:0}]}function c(t,e,n,r,i){var s,u,c;const l=i(null!=(s=m(t,e))?s:a.panic(`Invalid data format of '${e}'.`));let h=new Array(r.length);const f=m(t,"MappingInformationType"),d=m(t,"ReferenceInformationType");if("ByPolygon"===f){if("Direct"===d){o.assert(l.length===n.length,"Invalid length of normal list.");for(let t=0;t<l.length;t++)for(let e=0;e<n.length;e++)h[n[t][e]]=l[t]}else if("IndexToDirect"===d){const i=null!=(u=m(t,`${e}Index`))?u:a.panic(`${e}Index missing.`);o.assert(i.length===r.length,`Length of ${e}Index missmatch.`);for(let t=0;t<n.length;t++)for(let e=0;e<n[t].length;e++)h[n[t][e]]=l[i[t]]}}else if("ByPolygonVertex"===f){if("Direct"===d)o.assert(l.length===r.length,`Invalid length of ${e}`),h=l;else if("IndexToDirect"===d){const n=null!=(c=m(t,`${e}Index`))?c:a.panic(`${e}Index missing.`);o.assert(n.length===r.length,`Length of ${e}Index missmatch.`);for(let t=0;t<n.length;t++)h[t]=l[n[t]]}}else{if("ByEdge"===f)throw new Error(`Mapping '${e}' by edge is not supported.`);if("AllSame"!==f)throw new Error(`Unknown mapping type for '${e}'.`);for(let t=0;t<h.length;t++)h[t]=l[0]}return h}function l(t){o.assert(t.length%3==0,"Invalid data length for vec3 array.");const e=new Array(t.length/3);for(let n=0;n<t.length;n+=3)e[n/3]=i.vec3.fromValues(t[n],t[n+1],t[n+2]);return e}function h(t){o.assert(t.length%2==0,"Invalid data length for vec2 array.");const e=new Array(t.length/2);for(let n=0;n<t.length;n+=2)e[n/2]=i.vec2.fromValues(t[n],t[n+1]);return e}function f(t){const e=[];for(const n of t)if(3===n.length)e.push(...n);else{if(4!==n.length)throw new Error("Invalid polygon size.");e.push(n[0],n[1],n[2],n[0],n[2],n[3])}return e}function d(t){const e={id:t.properties[0],name:t.properties[1].split("\0")[0]},n=t.nestedNodes.find(t=>"Properties70"===t.name);if(n)for(const t of n.nestedNodes){const n=t.properties[0],r=t.properties[1];switch(r){case"KString":e[n]=t.properties[4];break;case"double":case"Number":e[n]=t.properties[4];break;case"Color":const[,,,,a,o,s]=t.properties;e[n]=i.vec4.fromValues(a,o,s,1);break;case"Bool":e[n]=1===t.properties[4];break;case"Vector3D":const[,,,,u,c,l]=t.properties;e[n]=i.vec3.fromValues(u,c,l);break;default:console.warn(`Unknown material property type '${r}'`)}}return e}function m(t,e,n=0){var r;return null===(r=t.nestedNodes.find(t=>t.name===e))||void 0===r?void 0:r.properties[n]}e.extractFBXAssets=function(t){const e=t.nodes.find(t=>"Objects"===t.name);if(!e)return{materials:[],models:[]};const n=new Map,r=e.nestedNodes.filter(t=>"Model"===t.name).map(s),i=e.nestedNodes.filter(t=>"Geometry"===t.name).map(u),a=e.nestedNodes.filter(t=>"Material"===t.name).map(d);for(const t of r)n.set(t.id,{type:"model",data:t});for(const t of i)n.set(t[0].id,{type:"geometry",data:t});for(const t of a)n.set(t.id,{type:"material",data:t});const o=t.nodes.find(t=>"Connections"===t.name);n.set(BigInt(0),{type:"null"}),o&&function(t,e){for(const n of t.nestedNodes){const[,t,r]=n.properties,i=e.get(t),a=e.get(r);i?a?"model"===i.type&&"model"===a.type?(i.data.transform.parent=a.data.transform,a.data.transform.children.push(i.data.transform)):"geometry"===i.type&&"model"===a.type?a.data.meshes=i.data:"material"===i.type&&"model"===a.type&&a.data.materials.push(i.data):console.warn(`Resource with id '${r}' is missing.`):console.warn(`Resource with id '${t}' is missing.`)}}(o,n);for(const t of r)for(const e of t.meshes)e.material=t.materials[e.mateiralId];return{materials:a,models:r}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9),i=n(16);e.FBXTransform=class{constructor(t,e=null){this.parent=null,this.children=[],this.localPosition=r.vec3.create(),this.localRotation=r.quat.identity(r.quat.create()),this.localScaling=r.vec3.fromValues(0,0,0),this.parent=e,this.model=t}get position(){if(!this.parent)return this.localPosition;let[t,e,n]=this.localPosition;return[t,e,n]=r.vec4.transformMat4(r.vec4.create(),r.vec4.fromValues(t,e,n,1),this.localToWorldMatrix),r.vec3.fromValues(t,e,n)}set position(t){this.parent?this.localPosition=i.mulPoint(this.localPosition,this.parent.localToWorldMatrix,this.localPosition):this.localPosition=t}get rotation(){return this.parent?r.quat.mul(r.quat.create(),this.parent.rotation,this.localRotation):this.localRotation}set rotation(t){this.parent?this.localRotation=r.quat.normalize(this.localRotation,r.quat.mul(this.localRotation,r.quat.invert(r.quat.create(),this.parent.rotation),t)):this.localRotation=r.quat.normalize(this.localRotation,this.localRotation)}get scaling(){return this.parent?r.vec3.mul(r.vec3.create(),this.parent.scaling,this.localScaling):this.localScaling}set scaling(t){this.parent?this.localScaling=r.vec3.div(this.localScaling,t,this.parent.scaling):this.localScaling=t}get localToWorldMatrix(){if(!this.parent)return r.mat4.fromRotationTranslationScale(r.mat4.create(),this.localRotation,this.localPosition,this.localScaling);const t=r.mat4.fromRotationTranslationScale(r.mat4.create(),this.localRotation,this.localPosition,this.localScaling);return r.mat4.mul(t,this.parent.localToWorldMatrix,t)}get worldToLocalMatrix(){return r.mat4.invert(this.localToWorldMatrix,this.localToWorldMatrix)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(23),i=n(14),a=n(18),o=n(1);e.TextureImporter={import:(t,e,n=o.GlobalContext())=>new Promise((e,o)=>{const s=new Blob([t]),u=new Image;u.src=URL.createObjectURL(s);const c=()=>{const t=new i.Texture2D(u.width,u.height,a.TextureFormat.RGBA,i.FilterMode.Linear,n);t.setData(u);const o=new r.AssetsPack;o.add("img",t),o.setMain(t),e(o)};u.complete?c():u.onload=c})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(29))},function(t,e,n){var r=n(74),i=n(75);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var a={insert:"head",singleton:!1},o=(r(t.i,i,a),i.locals?i.locals:{});t.exports=o},function(t,e,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),o={};function s(t,e,n){for(var r=0;r<e.length;r++){var i={css:e[r][1],media:e[r][2],sourceMap:e[r][3]};o[t][r]?o[t][r](i):o[t].push(v(i,n))}}function u(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var o=a(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var c,l=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function h(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=l(e,i);else{var a=document.createTextNode(i),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}function f(t,e,n){var r=n.css,i=n.media,a=n.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),a&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var d=null,m=0;function v(t,e){var n,r,i;if(e.singleton){var a=m++;n=d||(d=u(e)),r=h.bind(null,n,a,!1),i=h.bind(null,n,a,!0)}else n=u(e),r=f.bind(null,n,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e,n){return(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=i()),t=n.base?t+n.base:t,e=e||[],o[t]||(o[t]=[]),s(t,e,n),function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){o[t]||(o[t]=[]),s(t,e,n);for(var r=e.length;r<o[t].length;r++)o[t][r]();o[t].length=e.length,0===o[t].length&&delete o[t]}}}},function(t,e,n){(e=n(76)(!1)).push([t.i,"\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    display: flex;\r\n    flex-flow: column nowrap;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background-color: #EEE;\r\n    font-family: 'Open Sans', Roboto, Segoe UI, Microsoft Yahei UI, Tahoma, Geneva, Verdana, sans-serif;\r\n\r\n    background-position: 0px 0px,\r\n    16px 16px;\r\n    background-size: 32px 32px;\r\n    background-image: linear-gradient(45deg, #eee 25%, transparent 25%, transparent 75%, #eee 75%, #eee 100%),\r\n    linear-gradient(45deg, #eee 25%, white 25%, white 75%, #eee 75%, #eee 100%);\r\n}\r\n\r\n#root {\r\n    max-width: 100%;\r\n    max-height: 100%;\r\n}\r\n\r\n#canvas {\r\n    max-width: 100%;\r\n    max-height: 100%;\r\n}",""]),t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var i=(o=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),a=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[n].concat(a).concat([i]).join("\n")}var o,s,u;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r=0;r<t.length;r++){var i=[].concat(t[r]);n&&(i[2]?i[2]="".concat(n," and ").concat(i[2]):i[2]=n),e.push(i)}},e}},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\r\nprecision mediump float;\r\n\r\nin vec3 aPos;\r\nin vec4 aColor;\r\nin vec2 aUV;\r\nin vec3 aNormal;\r\n\r\nuniform mat4 uTransformM;\r\nuniform mat4 uTransformVP;\r\nuniform mat4 uTransformMVP;\r\nuniform mat4 uTransformM_IT;\r\n\r\nout vec4 vColor;\r\nout vec4 vPos;\r\nout vec2 vUV;\r\nout vec3 vNormal;\r\nout vec3 vWorldPos;\r\n\r\nvoid main()\r\n{\r\n    gl_Position = uTransformMVP * vec4(aPos, 1);\r\n    vPos = gl_Position;\r\n    vColor = aColor;\r\n    vUV = aUV;\r\n    vNormal = (uTransformM_IT *  vec4(aNormal, 0)).xyz;\r\n    vWorldPos = (uTransformM * vec4(aPos, 1)).xyz;\r\n    \r\n}"},,,function(t,e,n){"use strict";var r,i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(45),o=i(n(77)),s=i(n(81)),u=i(n(82));n(73);const c=i(n(83)),l=n(13),h=n(18),f=n(17),d=n(84),m=parseInt((r=/fps=(\d+)/.exec(window.location.search),null!=r?r:["","60"])[1]),v=a.vec2(650,850),p=document.querySelector("#canvas"),g=new a.ZograRenderer(p,window.innerWidth,window.innerHeight);class _ extends(a.MaterialFromShader(new a.Shader(o.default,s.default,{zWrite:!1,depth:a.DepthTest.Always}))){}const b=new _,w=new a.Material(new a.Shader(o.default,u.default));w.setProp("uBlockSize","float",2),w.setProp("uTexelSize","vec4",a.vec4(2446,1840,1/2446,1/1840)),w.setProp("uOffset","vec2",v),w.setProp("uSize","vec3",a.vec3(window.innerWidth,window.innerHeight,window.innerWidth/window.innerHeight)),w.setProp("uBG","color",a.Color.white),w.setProp("uFG","color",a.rgba(0,0,0,.5)),g.clear();const y=[new l.RenderTexture(2446,1840,!1,h.TextureFormat.RGBA,l.FilterMode.Nearest),new l.RenderTexture(2446,1840,!1,h.TextureFormat.RGBA,l.FilterMode.Nearest)];y[0].wrapMode=l.WrapMode.Clamp,y[1].wrapMode=l.WrapMode.Clamp,y[0].update(),y[1].update();new l.RenderTexture(2446,1840,!1);const M=new a.Mesh;M.verts=[a.vec3(-1,-1,0),a.vec3(1,-1,0),a.vec3(1,1,0),a.vec3(-1,1,0)],M.triangles=[0,1,3,1,2,3],M.uvs=[a.vec2(0,0),a.vec2(1,0),a.vec2(1,1),a.vec2(0,1)],M.calculateNormals(),(async()=>{let t=0,e=0;const n=await async function(){let t=0;const e=new ImageData(2446,1840),n=4500640;for(let t=0;t<3600512;t++){const t=4*Math.floor(Math.random()*n);e.data[t]=255}const r=await d.loadImage(c.default);return y[0].setData(r),setInterval(()=>{const e=y[t%2],n=y[(t+1)%2];t++,g.setGlobalTexture("uLastFrame",e),g.setGlobalUniform("uSize","vec4",a.vec4(2446,1840,1/2446,1/1840)),g.setRenderTarget(n),g.drawMesh(M,a.mat4.identity(),b)},1e3/m),(t,e)=>{g.blit(y[0],f.RenderTarget.CanvasTarget,w)}}(),r=i=>{0===t&&(t=i,e=i);const a=(i-t)/1e3;t=i,n(a,(i-e)/1e3),requestAnimationFrame(r)};requestAnimationFrame(r)})(),window.addEventListener("mousemove",t=>{const e=a.vec2(t.clientX,t.clientY),n=a.vec2(window.innerWidth/2,window.innerHeight/2),r=a.minus(e,n);r.mul(a.vec2(-.2,.2)),w.setProp("uOffset","vec2",a.plus(v,r))})},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\r\nprecision mediump float;\r\n\r\nin vec4 vColor;\r\nin vec4 vPos;\r\nin vec2 vUV;\r\n\r\nuniform vec4 uSize;\r\nuniform sampler2D uLastFrame;\r\n\r\nlayout (location = 0) out vec4 nextFrame;\r\n//layout (location = 1) out vec4 fragColor;\r\n\r\nfloat clampTex(vec2 pos)\r\n{\r\n    float col = texture(uLastFrame, pos).r;\r\n    vec2 clmp = step(vec2(0), pos) * (vec2(1) - step(vec2(1), pos));\r\n    return clmp.x * clmp.y * col;\r\n}\r\n\r\nint neighbors(vec2 pos)\r\n{\r\n    int n = 0;\r\n    vec3 delta = vec3(-1, 0, 1);\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.xx)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.xy)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.xz)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.yx)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.yz)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.zx)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.zy)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.zz)));\r\n    return n;\r\n}\r\n\r\nvoid main()\r\n{\r\n    float current = step(.5, texture(uLastFrame, vUV).r);\r\n    int n = neighbors(vUV);\r\n    if(current == 1.0)\r\n    {\r\n        if(n < 2)\r\n            nextFrame = vec4(0);\r\n        else if (n > 3)\r\n            nextFrame = vec4(0);\r\n        else\r\n            nextFrame = vec4(current);\r\n    }\r\n    else\r\n    {\r\n        if(n == 3)\r\n            nextFrame = vec4(1);\r\n    }\r\n    //nextFrame = vec4(1.0 - current);\r\n    // vec2 pos = vUV;\r\n    // vec3 color = vec3(texture(uLastFrame, vUV).rrr);\r\n    // color = vec3(vUV, 0);\r\n    // fragColor = vec4(current, current, current, 1);\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\r\nprecision mediump float;\r\n\r\nin vec4 vColor;\r\nin vec4 vPos;\r\nin vec2 vUV;\r\nin vec3 vNormal;\r\n\r\nuniform sampler2D uMainTex;\r\nuniform vec4 uTexelSize;\r\nuniform float uBlockSize;\r\nuniform vec2 uOffset;\r\nuniform vec3 uSize;\r\nuniform vec4 uBG;\r\nuniform vec4 uFG;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main()\r\n{\r\n    vec2 uv = uOffset * uTexelSize.zw + vUV * uSize.xy / uBlockSize * uTexelSize.zw;\r\n    float alpha = texture(uMainTex, uv).r;\r\n    alpha *= uFG.a;\r\n\r\n    fragColor = vec4(uBG.rgb * vec3(1.0 - alpha) + uFG.rgb * vec3(alpha), uBG.a);\r\n}"},function(t,e,n){"use strict";n.r(e),e.default=n.p+"static/img/dual-gun.png"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loadImage=async function(t){return new Promise((e,n)=>{const r=new Image;r.src=t,r.complete&&e(r),r.onload=()=>{e(r)},r.onerror=(t,e,r,i,a)=>{n(a)}})}}]);